<html>
<head>
<title>suggestions.txt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #080808;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
suggestions.txt</font>
</center></td></tr></table>
<pre><span class="s0">Before modification on 07/04/2024</span>

<span class="s0">// TODO:</span>
<span class="s0">// 1. Add the heat pump assessment to the heat pump costs and the bonus heat pump too.</span>
<span class="s0">// 2. Inform user of additional grants for other things that can be obtained.  Or maybe just show 1 in here too in a table for the homeowner.</span>
<span class="s0">// 3. Modify the recalculated grants total and homeownercost total to keep a running total of each individual recalculated grant and homeownercost instead of doing a full reculation at the end.</span>

<span class="s0">import React, { useState, useEffect } from 'react';</span>
<span class="s0">import { useNavigate, useLocation } from 'react-router-dom';</span>
<span class="s0">import Papa from 'papaparse';</span>
<span class="s0">import { getAuth, signOut } from 'firebase/auth';</span>

<span class="s0">function SuggestionsPage () {</span>
  <span class="s0">const navigate = useNavigate(); // Initialize the useNavigate hook</span>
  <span class="s0">const location = useLocation();</span>

  <span class="s0">const selectedProperty = location.state ? location.state.selectedProperty : null;</span>
  <span class="s0">const [newEnergyRating, setNewEnergyRating] = useState('');</span>
  <span class="s0">const [tempNewEnergyRating, setTempNewEnergyRating] = useState('');</span>
  <span class="s0">const [selectClass, setSelectClass] = useState('');</span>
  <span class="s0">const [archetype, setArchetype] = useState([]);</span>
  <span class="s0">const [seaiGrants, setSeaiGrants] = useState([]);</span>
  <span class="s0">const [selectedUValues, setSelectedUValues] = useState({});</span>
  <span class="s0">const [wallInsulationQuantity, setWallInsulationQuantity] = useState(selectedProperty ? selectedProperty.WallArea : 0);</span>
  <span class="s0">const [roofInsulationQuantity, setRoofInsulationQuantity] = useState(selectedProperty ? selectedProperty.RoofArea : 0);</span>
  <span class="s0">const [floorInsulationQuantity, setFloorInsulationQuantity] = useState(selectedProperty ? selectedProperty.FloorArea : 0);</span>
  <span class="s0">const [windowQuantity, setWindowQuantity] = useState(1);</span>
  <span class="s0">const [BackDoorQuantity, setBackDoorQuantity] = useState(1);</span>
  <span class="s0">const [FrontDoorQuantity, setFrontDoorQuantity] = useState(1);</span>
  <span class="s0">const [SolarPanelQuantity, setSolarPanelQuantity] = useState(1);</span>
  <span class="s0">const [SolarHotWaterQuantity, setSolarHotWaterQuantity] = useState(1);</span>
  <span class="s0">const [HeatPumpQuantity, setHeatPumpQuantity] = useState(1);</span>
  <span class="s0">const [CentralHeatingSystemQuantity, setCentralHeatingSystemQuantity] = useState(1);</span>
  <span class="s0">const [HeatingControlsQuantity, setHeatingControlsQuantity] = useState(1);</span>
  <span class="s0">const [MechanicalVentilationQuantity, setMechanicalVentilationQuantity] = useState(1);</span>
  <span class="s0">const [AirTightnessQuantity, setAirTightnessQuantity] = useState(1);</span>
  <span class="s0">const [totalEstimatedCost, setTotalEstimatedCost] = useState(0);</span>
  <span class="s0">const [totalAvailableGrant, setTotalAvailableGrant] = useState(0);</span>
  <span class="s0">const [totalRecalculatedGrant, setTotalRecalculatedGrant] = useState(0);</span>
  <span class="s0">const [totalCostToHomeowner, setTotalCostToHomeowner] = useState(0);</span>
  <span class="s0">const [selectedItemsCosts, setSelectedItemsCosts] = useState([]);</span>
  <span class="s0">const [selectedItemsGrants, setSelectedItemsGrants] = useState([]);</span>

  <span class="s0">const availableRatings = selectedProperty &amp;&amp; ['A1', 'A2', 'A3', 'B1', 'B2'].filter(rating =&gt; rating !== selectedProperty.EnergyRating &amp;&amp; rating &lt; selectedProperty.EnergyRating);</span>

  <span class="s0">const [thresholdValues, setThresholdValues] = useState({</span>
    <span class="s0">wall: 0, // Default values, will be updated dynamically</span>
    <span class="s0">roof: 0,</span>
    <span class="s0">floor: 0,</span>
    <span class="s0">window: 0,</span>
    <span class="s0">door: 0</span>
  <span class="s0">});</span>

  <span class="s0">const [lowestMeanValues, setLowestMeanValues] = useState({</span>
    <span class="s0">wall: 0,</span>
    <span class="s0">roof: 0,</span>
    <span class="s0">floor: 0,</span>
    <span class="s0">window: 0,</span>
    <span class="s0">door: 0</span>
  <span class="s0">});</span>

  <span class="s0">const [improvementCosts, setImprovementCosts] = useState({</span>
    <span class="s0">WallCavityInsulation: 0, // initial values</span>
    <span class="s0">WallInternalInsulation: 0,</span>
    <span class="s0">WallExternalInsulation: 0,</span>
    <span class="s0">AtticInsulation: 0,</span>
    <span class="s0">RafterInsulation: 0,</span>
    <span class="s0">FloorInsulation: 0,</span>
    <span class="s0">WindowReplacement: 0,</span>
    <span class="s0">BackDoorReplacement: 0,</span>
    <span class="s0">FrontDoorReplacement: 0,</span>
    <span class="s0">SolarPanels: 0,</span>
    <span class="s0">SolarHotWater: 0,</span>
    <span class="s0">HeatPumpAssessment: 0,</span>
    <span class="s0">HeatPumpAirToWater: 0,</span>
    <span class="s0">HeatPumpGroundSource: 0,</span>
    <span class="s0">HeatPumpExhaustAir: 0,</span>
    <span class="s0">HeatPumpWaterToWater: 0,</span>
    <span class="s0">HeatPumpAirToAir: 0,</span>
    <span class="s0">CentralHeatingSystem: 0,</span>
    <span class="s0">HeatingControls: 0,</span>
    <span class="s0">HeatPumpBonus: 0,</span>
    <span class="s0">MechanicalVentilation: 0,</span>
    <span class="s0">AirTightness: 0</span>
    <span class="s0">// other initial values</span>
  <span class="s0">});</span>

  <span class="s0">const [availableGrants, setAvailableGrants] = useState({</span>
    <span class="s0">WallCavityGrant: 0, // initial values</span>
    <span class="s0">WallInternalGrant: 0,</span>
    <span class="s0">WallExternalGrant: 0,</span>
    <span class="s0">AtticGrant: 0,</span>
    <span class="s0">RafterGrant: 0,</span>
    <span class="s0">FloorGrant: 0,</span>
    <span class="s0">WindowGrant: 0,</span>
    <span class="s0">BackDoorGrant: 0,</span>
    <span class="s0">FrontDoorGrant: 0,</span>
    <span class="s0">SolarPanelsGrant: 0,</span>
    <span class="s0">SolarHotWaterGrant: 0,</span>
    <span class="s0">HeatPumpAssessmentGrant: 0,</span>
    <span class="s0">HeatPumpAirToWaterGrant: 0,</span>
    <span class="s0">HeatPumpGroundSourceGrant: 0,</span>
    <span class="s0">HeatPumpExhaustAirGrant: 0,</span>
    <span class="s0">HeatPumpWaterToWaterGrant: 0,</span>
    <span class="s0">HeatPumpAirToAirGrant: 0,</span>
    <span class="s0">CentralHeatingSystemGrant: 0,</span>
    <span class="s0">HeatingControlsGrant: 0,</span>
    <span class="s0">HeatPumpBonusGrant: 0,</span>
    <span class="s0">MechanicalVentilationGrant: 0,</span>
    <span class="s0">AirTightnessGrant: 0</span>
    <span class="s0">// other initial values</span>
  <span class="s0">});</span>

  <span class="s0">const handleLogout = () =&gt; {</span>
    <span class="s0">const auth = getAuth();</span>
    <span class="s0">signOut(auth).then(() =&gt; {</span>
      <span class="s0">// Sign-out successful.</span>
      <span class="s0">navigate('/login'); // Redirect to login page after logout</span>
    <span class="s0">}).catch((error) =&gt; {</span>
      <span class="s0">// An error happened.</span>
      <span class="s0">console.error('Logout Error:', error);</span>
    <span class="s0">});</span>
  <span class="s0">};</span>

  <span class="s0">const handleUValueChange = (e, field) =&gt; {</span>
    <span class="s0">setSelectedUValues({ ...selectedUValues, [field]: e.target.checked });</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewEnergyRating = () =&gt; {</span>
    <span class="s0">setNewEnergyRating(tempNewEnergyRating);</span>
    <span class="s0">const newSelectClass = tempNewEnergyRating.startsWith('A') ? 'a-rating' : tempNewEnergyRating.startsWith('B') ? 'b-rating' : '';</span>
    <span class="s0">setSelectClass(newSelectClass);</span>

    <span class="s0">// Existing logic for updating target U-Values based on the new energy rating</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', tempNewEnergyRating);</span>
  <span class="s0">};</span>

  <span class="s0">const handleCheckboxChange = (e, improvementType, cost, grant) =&gt; {</span>
    <span class="s0">// Prevent scrolling when refocusing</span>
    <span class="s0">const x = window.scrollX; const y = window.scrollY;</span>
    <span class="s0">e.target.focus();</span>
    <span class="s0">window.scrollTo(x, y);</span>

    <span class="s0">const numericCost = parseFloat(cost);</span>
    <span class="s0">const numericGrant = parseFloat(grant);</span>

    <span class="s0">if (e.target.checked) {</span>
      <span class="s0">// Add the cost and grant of the selected item</span>
      <span class="s0">setSelectedItemsCosts(oldCosts =&gt; [...oldCosts, numericCost]);</span>
      <span class="s0">setSelectedItemsGrants(oldGrants =&gt; [...oldGrants, numericGrant]);</span>
    <span class="s0">} else {</span>
      <span class="s0">// Remove the cost and grant of the deselected item</span>
      <span class="s0">setSelectedItemsCosts(oldCosts =&gt; oldCosts.filter(itemCost =&gt; itemCost !== numericCost));</span>
      <span class="s0">setSelectedItemsGrants(oldGrants =&gt; oldGrants.filter(itemGrant =&gt; itemGrant !== numericGrant));</span>
    <span class="s0">}</span>
  <span class="s0">};</span>

  <span class="s0">useEffect(() =&gt; {</span>
    <span class="s0">// Set the initial wall insulation quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.WallArea) {</span>
      <span class="s0">setWallInsulationQuantity(selectedProperty.WallArea);</span>
    <span class="s0">}</span>

    <span class="s0">// Set the initial roof insulation quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.RoofArea) {</span>
      <span class="s0">setRoofInsulationQuantity(selectedProperty.RoofArea);</span>
    <span class="s0">}</span>

    <span class="s0">// Set the initial floor insulation quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.FloorArea) {</span>
      <span class="s0">setFloorInsulationQuantity(selectedProperty.FloorArea);</span>
    <span class="s0">}</span>

    <span class="s0">// Set the SolarHotWater quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.SolarHotWater) {</span>
      <span class="s0">setSolarHotWaterQuantity(selectedProperty.SolarHotWater);</span>
    <span class="s0">}</span>

    <span class="s0">// Set the HeatPump quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.HeatPump) {</span>
      <span class="s0">setHeatPumpQuantity(selectedProperty.HeatPump);</span>
    <span class="s0">}</span>

    <span class="s0">// Set the CentralHeatingSystem quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.CentralHeatingSystem) {</span>
      <span class="s0">setCentralHeatingSystemQuantity(selectedProperty.CentralHeatingSystem);</span>
    <span class="s0">}</span>

    <span class="s0">// Set the HeatingControls quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.HeatingControls) {</span>
      <span class="s0">setHeatingControlsQuantity(selectedProperty.HeatingControls);</span>
    <span class="s0">}</span>

    <span class="s0">// Set the MechanicalVentilation quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.MechanicalVentilation) {</span>
      <span class="s0">setMechanicalVentilationQuantity(selectedProperty.MechanicalVentilation);</span>
    <span class="s0">}</span>

    <span class="s0">// Set the AirTightness quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.AirTightness) {</span>
      <span class="s0">setAirTightnessQuantity(selectedProperty.AirTightness);</span>
    <span class="s0">}</span>

    <span class="s0">// Define a function to fetch and parse the SEAI grants data</span>
    <span class="s0">const fetchSEAIgrants = async () =&gt; {</span>
      <span class="s0">const response = await fetch('/data/seai_grants.csv');</span>
      <span class="s0">const text = await response.text();</span>
      <span class="s0">return Papa.parse(text, { header: true, dynamicTyping: true }).data;</span>
    <span class="s0">};</span>

    <span class="s0">// Define a function to fetch and parse the building archetype data</span>
    <span class="s0">const fetchArchetypeData = async () =&gt; {</span>
      <span class="s0">const response = await fetch('/data/data_building_archetype.csv');</span>
      <span class="s0">const text = await response.text();</span>
      <span class="s0">return Papa.parse(text, { header: true, dynamicTyping: true }).data;</span>
    <span class="s0">};</span>

    <span class="s0">// Use Promise.all to fetch both datasets concurrently</span>
    <span class="s0">Promise.all([fetchSEAIgrants(), fetchArchetypeData()]).then(([seaiGrantsData, archetypeData]) =&gt; {</span>
      <span class="s0">setSeaiGrants(seaiGrantsData);</span>
      <span class="s0">setArchetype(archetypeData);</span>

      <span class="s0">// Assuming selectedDwellingType holds type like 'Semi-detached house'</span>
      <span class="s0">const dwellingType = selectedProperty ? selectedProperty.DwellingTypeDescr : '';</span>
      <span class="s0">const newRating = newEnergyRating;</span>

      <span class="s0">// Added in to remove the eslint error message</span>
      <span class="s0">if (archetype.length === 0) {</span>
        <span class="s0">return; // Exit if archetype data is not available</span>
      <span class="s0">}</span>

      <span class="s0">// Find matching row for new energy rating and dwelling type from archetype data</span>
      <span class="s0">const matchedRow = archetypeData.find(row =&gt; row.DwellingType === dwellingType &amp;&amp; row.EnergyRating === newRating);</span>

      <span class="s0">// If a matching row is found, update the threshold values</span>
      <span class="s0">if (matchedRow) {</span>
        <span class="s0">setThresholdValues({</span>
          <span class="s0">wall: matchedRow.UValueWallMean,</span>
          <span class="s0">roof: matchedRow.UValueRoofMean,</span>
          <span class="s0">floor: matchedRow.UValueFloorMean,</span>
          <span class="s0">window: matchedRow.UValueWindowMean,</span>
          <span class="s0">door: matchedRow.UValueDoorMean</span>
        <span class="s0">});</span>
      <span class="s0">}</span>

      <span class="s0">// Find the Energy Rating A1 for dwelling type from archetype data</span>
      <span class="s0">const lowestMeanRow = archetypeData.find(row =&gt; row.DwellingType === dwellingType &amp;&amp; row.EnergyRating === 'A1');</span>

      <span class="s0">// If a matching row is found, update the lowest mean values</span>
      <span class="s0">if (lowestMeanRow) {</span>
        <span class="s0">setLowestMeanValues({</span>
          <span class="s0">wall: lowestMeanRow.UValueWallMean,</span>
          <span class="s0">roof: lowestMeanRow.UValueRoofMean,</span>
          <span class="s0">floor: lowestMeanRow.UValueFloorMean,</span>
          <span class="s0">window: lowestMeanRow.UValueWindowMean,</span>
          <span class="s0">door: lowestMeanRow.UValueDoorMean</span>
        <span class="s0">});</span>
      <span class="s0">}</span>

      <span class="s0">// Update improvement costs and available grants based on SEAI grants data and dwelling type</span>
      <span class="s0">const updatedImprovementCosts = { ...improvementCosts };</span>
      <span class="s0">const updatedAvailableGrants = { ...availableGrants };</span>

      <span class="s0">// Added in to remove the eslint error message</span>
      <span class="s0">if (seaiGrants.length === 0) {</span>
        <span class="s0">return;</span>
      <span class="s0">}</span>

      <span class="s0">seaiGrantsData.forEach(grant =&gt; {</span>
        <span class="s0">console.log(grant); // To check what's in each grant entry</span>
        <span class="s0">if (grant.DwellingTypes === dwellingType) {</span>
          <span class="s0">switch (grant.GrantName) { // Use 'GrantName' as in the CSV</span>
            <span class="s0">case 'Cavity wall insulation': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.WallCavityInsulation = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.WallCavityGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Internal Insulation (Dry Lining)': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.WallInternalInsulation = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.WallInternalGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'External Wall Insulation (The Wrap)': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.WallExternalInsulation = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.WallExternalGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Attic insulation': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.AtticInsulation = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.AtticGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Rafter insulation': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.RafterInsulation = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.RafterGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Floor Insulation': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.FloorInsulation = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.FloorGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Windows (Complete Upgrade)': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.WindowReplacement = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.WindowGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'External Back door': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.BackDoorReplacement = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.BackDoorGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'External Front door': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.FrontDoorReplacement = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.FrontDoorGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Solar PV Grant': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.SolarPanels = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.SolarPanelsGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Solar Hot Water': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.SolarHotWater = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.SolarHotWaterGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Heat Pump Technical Assessment': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HeatPumpAssessment = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HeatPumpAssessmentGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Air to Water heat pump system': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HeatPumpAirToWater = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HeatPumpAirToWaterGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Ground Source to Water heat pump system': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HeatPumpGroundSource = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HeatPumpGroundSourceGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Exhaust Air to Water heat pump system': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HeatPumpExhaustAir = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HeatPumpExhaustAirGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Water to Water heat pump system': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HeatPumpWaterToWater = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HeatPumpWaterToWaterGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Air to Air heat pump system': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HeatPumpAirToAir = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HeatPumpAirToAirGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Central Heating System for Heat Pump': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.CentralHeatingSystem = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.CentralHeatingSystemGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Heating Controls': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HeatingControls = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HeatingControlsGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Heat Pump Bonus': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HeatPumpBonus = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HeatPumpBonusGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Mechanical Ventilation': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.MechanicalVentilation = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.MechanicalVentilationGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Air Tightness': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.AirTightness = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.AirTightnessGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Home Energy Assessment': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.HomeEnergyAssessment = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.HomeEnergyAssessmentGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
            <span class="s0">case 'Project Management': // Use the exact name from the CSV</span>
              <span class="s0">updatedImprovementCosts.ProjectManagement = grant.EstimatedImprovementCost;</span>
              <span class="s0">updatedAvailableGrants.ProjectManagementGrant = grant.GrantValue;</span>
              <span class="s0">break;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">});</span>

      <span class="s0">setImprovementCosts(updatedImprovementCosts);</span>
      <span class="s0">setAvailableGrants(updatedAvailableGrants);</span>
    <span class="s0">});</span>

    <span class="s0">let SolarPanelQuantity = 0;</span>
    <span class="s0">switch (selectedProperty.DwellingTypeDescr) {</span>
      <span class="s0">case 'Mid-terrace house':</span>
        <span class="s0">SolarPanelQuantity = 8;</span>
        <span class="s0">break;</span>
      <span class="s0">case 'Semi-detached house':</span>
        <span class="s0">SolarPanelQuantity = 10;</span>
        <span class="s0">break;</span>
      <span class="s0">case 'End of terrace house':</span>
        <span class="s0">SolarPanelQuantity = 8;</span>
        <span class="s0">break;</span>
      <span class="s0">case 'House':</span>
        <span class="s0">SolarPanelQuantity = 12;</span>
        <span class="s0">break;</span>
      <span class="s0">case 'Detached house':</span>
        <span class="s0">SolarPanelQuantity = 16;</span>
        <span class="s0">break;</span>
      <span class="s0">default: SolarPanelQuantity = 0;</span>
    <span class="s0">}</span>
    <span class="s0">setSolarPanelQuantity(SolarPanelQuantity);</span>

    <span class="s0">const totalCost = selectedItemsCosts.reduce((acc, cur) =&gt; acc + cur, 0);</span>
    <span class="s0">const totalGrant = selectedItemsGrants.reduce((acc, cur) =&gt; acc + cur, 0);</span>
    <span class="s0">const recalculatedGrant = Math.min(totalGrant, totalCost * 0.5); // Ensure grant doesn't exceed 50% of the total cost</span>
    <span class="s0">const homeownerCost = Math.max(0, totalCost - recalculatedGrant); // Ensure homeowner cost doesn't go below 0</span>

    <span class="s0">setTotalEstimatedCost(totalCost);</span>
    <span class="s0">setTotalAvailableGrant(totalGrant);</span>
    <span class="s0">setTotalRecalculatedGrant(recalculatedGrant);</span>
    <span class="s0">setTotalCostToHomeowner(homeownerCost);</span>
  <span class="s0">}, [selectedProperty, newEnergyRating, selectedItemsCosts, selectedItemsGrants]); // Ensure useEffect is triggered when these values change</span>

  <span class="s0">// Display the selected property and inputs for modifying U-values</span>
  <span class="s0">return (</span>
      <span class="s0">&lt;&gt;</span>
        <span class="s0">&lt;div&gt;</span>
          <span class="s0">{/* Logout Button */}</span>
          <span class="s0">&lt;button type=&quot;button&quot; className=&quot;logout-button&quot; onClick={handleLogout}&gt;Logout&lt;/button&gt;</span>
        <span class="s0">&lt;/div&gt;</span>
        <span class="s0">&lt;div&gt;</span>
          <span class="s0">&lt;h1&gt;Your Selected Property Details&lt;/h1&gt;</span>
          <span class="s0">{selectedProperty &amp;&amp; (</span>
              <span class="s0">&lt;div className=&quot;properties-container&quot;&gt;</span>
                <span class="s0">&lt;table className=&quot;properties-table&quot;&gt;</span>
                  <span class="s0">&lt;thead&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;th&gt;Property ID&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Dwelling Type&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Year of Construction&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Energy Rating&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;BER Rating&lt;/th&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;/thead&gt;</span>
                  <span class="s0">&lt;tbody&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;{selectedProperty.PropertyID}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{selectedProperty.DwellingTypeDescr}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{selectedProperty.Year_of_Construction}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{selectedProperty.EnergyRating}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{selectedProperty.BerRating}&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;/tbody&gt;</span>
                <span class="s0">&lt;/table&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
          <span class="s0">)}</span>
        <span class="s0">&lt;/div&gt;</span>
        <span class="s0">&lt;div className=&quot;return-button-container&quot;&gt;</span>
          <span class="s0">&lt;button</span>
              <span class="s0">type=&quot;button&quot;</span>
              <span class="s0">className=&quot;button-blue return-to-form&quot;</span>
              <span class="s0">onClick={() =&gt; navigate('/BerRatingForm')} // Adjust the path as necessary</span>
          <span class="s0">&gt;</span>
            <span class="s0">Start New Property Search</span>
          <span class="s0">&lt;/button&gt;</span>
        <span class="s0">&lt;/div&gt;</span>
        <span class="s0">&lt;div className=&quot;new-energy-rating-container&quot;&gt;</span>
          <span class="s0">&lt;h2&gt;Select new energy rating category to compare your existing U-Values&lt;/h2&gt;</span>
          <span class="s0">&lt;p&gt;</span>
            <span class="s0">Choosing a new energy rating category for your home is a proactive step towards improving your living</span>
            <span class="s0">environment and reducing your energy bills.</span>
            <span class="s0">A higher energy rating category means that your home is more energy-efficient, meaning that your home</span>
            <span class="s0">retains more heat and uses less energy to maintain a comfortable temperature.</span>
            <span class="s0">This not only improves comfort, but also reduces the need for excessive heating or cooling, leading to lower</span>
            <span class="s0">energy bills and a reduced carbon footprint.</span>
            <span class="s0">Select a new energy rating category to compare your existing U-Values with the recommended U-Values for the</span>
            <span class="s0">selected energy rating category.</span>
            <span class="s0">Any discrepancies between the existing and recommended U-Values will be highlighted.</span>
            <span class="s0">If your existing U-Values are higher than the recommended U-Values, these will be highlighted in red,</span>
            <span class="s0">indicating areas where improvements can be made to improve the energy efficiency of your home.</span>
            <span class="s0">You can then explore the potential improvements that can be made to your home to achieve the selected energy</span>
            <span class="s0">rating category, with the potential grants you can receive.</span>
            <span class="s0">If your existing U-Values are lower than the recommended U-Values, these will be highlighted in green,</span>
            <span class="s0">indicating areas where your home already meets or exceeds the energy efficiency requirements for the</span>
            <span class="s0">selected energy rating category.</span>
            <span class="s0">This may mean that your home could require some additional improvements, as other factors such as</span>
            <span class="s0">air tightness and ventilation also play a role in determining the energy rating of your home.</span>
            <span class="s0">Thus, it may be necessary to select a different energy rating category to see how your existing U-Values</span>
            <span class="s0">compare.</span>
          <span class="s0">&lt;/p&gt;</span>
          <span class="s0">&lt;select</span>
              <span class="s0">value={tempNewEnergyRating}</span>
              <span class="s0">onChange={e =&gt; setTempNewEnergyRating(e.target.value)}</span>
              <span class="s0">className={`energy-rating-select ${selectClass}`}</span>
          <span class="s0">&gt;</span>
            <span class="s0">&lt;option value=&quot;&quot;&gt;Select New Energy Rating&lt;/option&gt;</span>
            <span class="s0">{availableRatings &amp;&amp; availableRatings.map(rating =&gt; (</span>
                <span class="s0">&lt;option key={rating} value={rating}&gt;{rating}&lt;/option&gt;</span>
            <span class="s0">))}</span>
          <span class="s0">&lt;/select&gt;</span>
          <span class="s0">&lt;button onClick={submitNewEnergyRating} className=&quot;button-blue&quot;&gt;Submit&lt;/button&gt;</span>
        <span class="s0">&lt;/div&gt;</span>
        <span class="s0">&lt;div className=&quot;u-values-table-container&quot;&gt;</span>
          <span class="s0">&lt;h2&gt;Target U-Values vs Existing U-Values for {newEnergyRating} Energy Rating Category&lt;/h2&gt;</span>
          <span class="s0">&lt;p&gt;</span>
            <span class="s0">If your existing U-Values are higher than the recommended U-Values, these will be highlighted in</span>
            <span class="s0">&lt;span className=&quot;color-block red&quot;&gt;&lt;/span&gt;&lt;span className=&quot;color-word&quot;&gt;red&lt;/span&gt;,</span>
            <span class="s0">indicating areas where improvements can be made to improve the energy efficiency of your home.&lt;br&gt;&lt;/br&gt;</span>
            <span class="s0">If your existing U-Values are lower than the recommended U-Values, these will be highlighted in</span>
            <span class="s0">&lt;span className=&quot;color-block green&quot;&gt;&lt;/span&gt;&lt;span className=&quot;color-word&quot;&gt;green&lt;/span&gt;,</span>
            <span class="s0">indicating areas where your home already meets or exceeds the energy efficiency requirements for the</span>
            <span class="s0">selected energy rating category.&lt;br&gt;&lt;/br&gt;</span>
            <span class="s0">If your existing U-Values are close to the recommended U-Values, these will be highlighted in</span>
            <span class="s0">&lt;span className=&quot;color-block amber&quot;&gt;&lt;/span&gt;&lt;span className=&quot;color-word&quot;&gt;amber&lt;/span&gt;,</span>
            <span class="s0">indicating that your home meets the minimum standards but could still benefit from improvements.</span>
          <span class="s0">&lt;/p&gt;</span>

          <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
            <span class="s0">&lt;thead&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;th&gt;U-Value Types&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Target U-Values&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Existing U-Values&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Description&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Select U-Values for Retrofitting&lt;/th&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;/thead&gt;</span>
            <span class="s0">&lt;tbody&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;th&gt;Walls UValue&lt;/th&gt;</span>
              <span class="s0">&lt;td&gt;{thresholdValues.wall}&lt;/td&gt;</span>
              <span class="s0">&lt;td className={`value-cell ${</span>
                  <span class="s0">selectedProperty.UValueWall &gt; thresholdValues.wall</span>
                      <span class="s0">? 'u-value-high'</span>
                      <span class="s0">: selectedProperty.UValueWall &lt; thresholdValues.wall &amp;&amp; selectedProperty.UValueWall &gt; lowestMeanValues.wall</span>
                          <span class="s0">? 'u-value-medium'</span>
                          <span class="s0">: 'u-value-low'</span>
              <span class="s0">}`}&gt;</span>
                <span class="s0">{selectedProperty.UValueWall}</span>
              <span class="s0">&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{</span>
                <span class="s0">selectedProperty.UValueWall &gt; thresholdValues.wall</span>
                  <span class="s0">? 'Your walls are not holding heat well. Consider upgrading insulation.'</span>
                  <span class="s0">: selectedProperty.UValueWall &lt; thresholdValues.wall &amp;&amp; selectedProperty.UValueWall &gt; lowestMeanValues.wall</span>
                    <span class="s0">? 'Your walls meet the minimum standard, but improvements could still be beneficial.'</span>
                    <span class="s0">: 'Your walls are well insulated against heat loss.'</span>
              <span class="s0">}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;button type=&quot;button&quot; className=&quot;button-blue&quot;</span>
                        <span class="s0">onClick={() =&gt; handleUValueChange({ target: { checked: !selectedUValues.UValueWall } }, 'UValueWall')}&gt;</span>
                  <span class="s0">{selectedUValues.UValueWall ? 'Deselect' : 'Select'}</span>
                <span class="s0">&lt;/button&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;th&gt;Roof UValue&lt;/th&gt;</span>
              <span class="s0">&lt;td&gt;{thresholdValues.roof}&lt;/td&gt;</span>
              <span class="s0">&lt;td className={`value-cell ${</span>
                  <span class="s0">selectedProperty.UValueRoof &gt; thresholdValues.roof</span>
                      <span class="s0">? 'u-value-high'</span>
                      <span class="s0">: selectedProperty.UValueRoof &lt; thresholdValues.roof &amp;&amp; selectedProperty.UValueRoof &gt; lowestMeanValues.roof</span>
                          <span class="s0">? 'u-value-medium'</span>
                          <span class="s0">: 'u-value-low'</span>
              <span class="s0">}`}&gt;</span>
                <span class="s0">{selectedProperty.UValueRoof}</span>
              <span class="s0">&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{</span>
                <span class="s0">selectedProperty.UValueRoof &gt; thresholdValues.roof</span>
                  <span class="s0">? 'Your roof is not insulating well. Consider upgrading insulation.'</span>
                  <span class="s0">: selectedProperty.UValueRoof &lt; thresholdValues.roof &amp;&amp; selectedProperty.UValueRoof &gt; lowestMeanValues.roof</span>
                    <span class="s0">? 'Your roof meets the minimum standard, but improvements could still be beneficial.'</span>
                    <span class="s0">: 'Your roof is well insulated against heat loss.'</span>
              <span class="s0">}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;button type=&quot;button&quot; className=&quot;button-blue&quot;</span>
                        <span class="s0">onClick={() =&gt; handleUValueChange({ target: { checked: !selectedUValues.UValueRoof } }, 'UValueRoof')}&gt;</span>
                  <span class="s0">{selectedUValues.UValueRoof ? 'Deselect' : 'Select'}</span>
                <span class="s0">&lt;/button&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;th&gt;Floors UValue&lt;/th&gt;</span>
              <span class="s0">&lt;td&gt;{thresholdValues.floor}&lt;/td&gt;</span>
              <span class="s0">&lt;td className={`value-cell ${</span>
                  <span class="s0">selectedProperty.UValueFloor &gt; thresholdValues.floor</span>
                      <span class="s0">? 'u-value-high'</span>
                      <span class="s0">: selectedProperty.UValueFloor &lt; thresholdValues.floor &amp;&amp; selectedProperty.UValueFloor &gt; lowestMeanValues.floor</span>
                          <span class="s0">? 'u-value-medium'</span>
                          <span class="s0">: 'u-value-low'</span>
              <span class="s0">}`}&gt;</span>
                <span class="s0">{selectedProperty.UValueFloor}</span>
              <span class="s0">&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{</span>
                <span class="s0">selectedProperty.UValueFloor &gt; thresholdValues.floor</span>
                  <span class="s0">? 'Your floors are not insulating well. Consider upgrading insulation.'</span>
                  <span class="s0">: selectedProperty.UValueFloor &lt; thresholdValues.floor &amp;&amp; selectedProperty.UValueFloor &gt; lowestMeanValues.floor</span>
                    <span class="s0">? 'Your floors meet the minimum standard, but improvements could still be beneficial.'</span>
                    <span class="s0">: 'Your floors are well insulated against heat loss.'</span>
              <span class="s0">}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;button type=&quot;button&quot; className=&quot;button-blue&quot;</span>
                        <span class="s0">onClick={() =&gt; handleUValueChange({ target: { checked: !selectedUValues.UValueFloor } }, 'UValueFloor')}&gt;</span>
                  <span class="s0">{selectedUValues.UValueFloor ? 'Deselect' : 'Select'}</span>
                <span class="s0">&lt;/button&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;th&gt;Windows UValue&lt;/th&gt;</span>
              <span class="s0">&lt;td&gt;{thresholdValues.window}&lt;/td&gt;</span>
              <span class="s0">&lt;td className={`value-cell ${</span>
                  <span class="s0">selectedProperty.UValueWindow &gt; thresholdValues.window</span>
                      <span class="s0">? 'u-value-high'</span>
                      <span class="s0">: selectedProperty.UValueWindow &lt; thresholdValues.window &amp;&amp; selectedProperty.UValueWindow &gt; lowestMeanValues.window</span>
                          <span class="s0">? 'u-value-medium'</span>
                          <span class="s0">: 'u-value-low'</span>
              <span class="s0">}`}&gt;</span>
                <span class="s0">{selectedProperty.UValueWindow}</span>
              <span class="s0">&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{</span>
                <span class="s0">selectedProperty.UValueWindow &gt; thresholdValues.window</span>
                  <span class="s0">? 'Your windows are not insulating well. Consider upgrading to double or triple glazing.'</span>
                  <span class="s0">: selectedProperty.UValueWindow &lt; thresholdValues.window &amp;&amp; selectedProperty.UValueWindow &gt; lowestMeanValues.window</span>
                    <span class="s0">? 'Your windows meet the minimum standard, but improvements could still be beneficial.'</span>
                    <span class="s0">: 'Your windows are well insulated against heat loss.'</span>
              <span class="s0">}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;button type=&quot;button&quot; className=&quot;button-blue&quot;</span>
                        <span class="s0">onClick={() =&gt; handleUValueChange({ target: { checked: !selectedUValues.UValueWindow } }, 'UValueWindow')}&gt;</span>
                  <span class="s0">{selectedUValues.UValueWindow ? 'Deselect' : 'Select'}</span>
                <span class="s0">&lt;/button&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;th&gt;Doors UValue&lt;/th&gt;</span>
              <span class="s0">&lt;td&gt;{thresholdValues.door}&lt;/td&gt;</span>
              <span class="s0">&lt;td className={`value-cell ${</span>
                  <span class="s0">selectedProperty.UvalueDoor &gt; thresholdValues.door</span>
                      <span class="s0">? 'u-value-high'</span>
                      <span class="s0">: selectedProperty.UvalueDoor &lt; thresholdValues.door &amp;&amp; selectedProperty.UvalueDoor &gt; lowestMeanValues.door</span>
                          <span class="s0">? 'u-value-medium'</span>
                          <span class="s0">: 'u-value-low'</span>
              <span class="s0">}`}&gt;</span>
                <span class="s0">{selectedProperty.UvalueDoor}</span>
              <span class="s0">&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{</span>
                <span class="s0">selectedProperty.UvalueDoor &gt; thresholdValues.door</span>
                  <span class="s0">? 'Your doors are not insulating well. Consider upgrading to insulated doors.'</span>
                  <span class="s0">: selectedProperty.UvalueDoor &lt; thresholdValues.door &amp;&amp; selectedProperty.UvalueDoor &gt; lowestMeanValues.door</span>
                    <span class="s0">? 'Your doors meet the minimum standard, but improvements could still be beneficial.'</span>
                    <span class="s0">: 'Your doors are well insulated against heat loss.'</span>
              <span class="s0">}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;button type=&quot;button&quot; className=&quot;button-blue&quot;</span>
                        <span class="s0">onClick={() =&gt; handleUValueChange({ target: { checked: !selectedUValues.UvalueDoor } }, 'UvalueDoor')}&gt;</span>
                  <span class="s0">{selectedUValues.UvalueDoor ? 'Deselect' : 'Select'}</span>
                <span class="s0">&lt;/button&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;/tbody&gt;</span>
          <span class="s0">&lt;/table&gt;</span>
        <span class="s0">&lt;/div&gt;</span>
        <span class="s0">&lt;div className=&quot;optional-table-container&quot;&gt;</span>
          <span class="s0">&lt;h2&gt;Select optional items to install&lt;/h2&gt;</span>
          <span class="s0">&lt;table className=&quot;optional-table&quot;&gt;</span>
            <span class="s0">&lt;thead&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;th&gt;Other Improvements&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Select&lt;/th&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;/thead&gt;</span>
            <span class="s0">&lt;tbody&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;td&gt;Solar Panels&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;button type=&quot;button&quot; className=&quot;button-blue&quot;</span>
                        <span class="s0">onClick={() =&gt; handleUValueChange({ target: { checked: !selectedUValues.SolarPanels } }, 'SolarPanels')}&gt;</span>
                  <span class="s0">{selectedUValues.SolarPanels ? 'Deselect' : 'Select'}</span>
                <span class="s0">&lt;/button&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;td&gt;Heat Pump&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;button type=&quot;button&quot; className=&quot;button-blue&quot;</span>
                        <span class="s0">onClick={() =&gt; handleUValueChange({ target: { checked: !selectedUValues.HeatPump } }, 'HeatPump')}&gt;</span>
                  <span class="s0">{selectedUValues.HeatPump ? 'Deselect' : 'Select'}</span>
                <span class="s0">&lt;/button&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;/tbody&gt;</span>
          <span class="s0">&lt;/table&gt;</span>
        <span class="s0">&lt;/div&gt;</span>

        <span class="s0">&lt;div className=&quot;improvements-table-container&quot;&gt;</span>
          <span class="s0">&lt;h2&gt;Improvement Estimates for {selectedProperty.DwellingTypeDescr}&lt;/h2&gt;</span>
          <span class="s0">&lt;p&gt;</span>
            <span class="s0">Based on the selected improvements, the estimated costs and potential grants are displayed below.</span>
            <span class="s0">The estimated costs are based on the average costs for each improvement, while the potential grants</span>
            <span class="s0">are based on the SEAI grants available for each improvement.</span>
            <span class="s0">The total estimated cost and potential grants are also displayed.</span>
            <span class="s0">The estimated savings are based on the energy savings from the improvements and the potential grants</span>
            <span class="s0">received.</span>
          <span class="s0">&lt;/p&gt;</span>
          <span class="s0">&lt;table className=&quot;improvements-table&quot;&gt;</span>
            <span class="s0">&lt;thead&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;th&gt;Improvement&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Quantity&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Estimated Works Cost&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Maximum Available SEAI Grant*&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Recalculated SEAI Grant&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Estimated Cost to Homeowner&lt;/th&gt;</span>
              <span class="s0">&lt;th&gt;Select items to apply for grants&lt;/th&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;/thead&gt;</span>
            <span class="s0">&lt;tbody&gt;</span>
            <span class="s0">{selectedUValues.UValueWall &amp;&amp; (</span>
                <span class="s0">&lt;&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Cavity Wall Insulation&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{wallInsulationQuantity} m&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.WallCavityInsulation * wallInsulationQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.WallCavityGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.min(availableGrants.WallCavityGrant, (improvementCosts.WallCavityInsulation * wallInsulationQuantity) / 2 || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.WallCavityInsulation * wallInsulationQuantity) - Math.min(availableGrants.WallCavityGrant, (improvementCosts.WallCavityInsulation * wallInsulationQuantity) / 2) || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyCavityWallInsulation&quot; name=&quot;applyCavityWallInsulationGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'WallCavityInsulation',</span>
                                 <span class="s0">improvementCosts.WallCavityInsulation * wallInsulationQuantity,</span>
                                 <span class="s0">availableGrants.WallCavityGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyCavityWallInsulation&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Internal Wall Insulation&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{wallInsulationQuantity} m&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.WallInternalInsulation * wallInsulationQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.WallInternalGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.min(availableGrants.WallInternalGrant, (improvementCosts.WallInternalInsulation * wallInsulationQuantity) / 2 || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.WallInternalInsulation * wallInsulationQuantity) - Math.min(availableGrants.WallInternalGrant, (improvementCosts.WallInternalInsulation * wallInsulationQuantity) / 2) || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyInternalWallInsulation&quot; name=&quot;applyInternalWallInsulationGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'WallInternalInsulation',</span>
                                 <span class="s0">improvementCosts.WallInternalInsulation * wallInsulationQuantity,</span>
                                 <span class="s0">availableGrants.WallInternalGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyInternalWallInsulation&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;External Wall Insulation&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{wallInsulationQuantity} m&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.WallExternalInsulation * wallInsulationQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.WallExternalGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.min(availableGrants.WallExternalGrant, (improvementCosts.WallExternalInsulation * wallInsulationQuantity) / 2 || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.WallExternalInsulation * wallInsulationQuantity) - Math.min(availableGrants.WallExternalGrant, (improvementCosts.WallExternalInsulation * wallInsulationQuantity) / 2) || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyExternalWallInsulation&quot; name=&quot;applyExternalWallInsulationGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'WallExternalInsulation',</span>
                                 <span class="s0">improvementCosts.WallExternalInsulation * wallInsulationQuantity,</span>
                                 <span class="s0">availableGrants.WallExternalGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyExternalWallInsulation&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>

                  <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/&gt;</span>
            <span class="s0">)}</span>
            <span class="s0">{selectedUValues.UValueRoof &amp;&amp; (</span>
                <span class="s0">&lt;&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Attic Insulation&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{roofInsulationQuantity} m&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.AtticInsulation * roofInsulationQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.AtticGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.min(availableGrants.AtticGrant, (improvementCosts.AtticInsulation * roofInsulationQuantity) / 2 || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.AtticInsulation * roofInsulationQuantity) - Math.min(availableGrants.AtticGrant, (improvementCosts.AtticInsulation * roofInsulationQuantity) / 2) || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyAtticInsulation&quot; name=&quot;applyAtticInsulationGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'AtticInsulation',</span>
                                 <span class="s0">improvementCosts.AtticInsulation * roofInsulationQuantity,</span>
                                 <span class="s0">availableGrants.AtticGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyAtticInsulation&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Rafter Insulation&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{roofInsulationQuantity} m&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.RafterInsulation * roofInsulationQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.RafterGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.min(availableGrants.RafterGrant, (improvementCosts.RafterInsulation * roofInsulationQuantity) / 2 || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.RafterInsulation * roofInsulationQuantity) - Math.min(availableGrants.RafterGrant, (improvementCosts.RafterInsulation * roofInsulationQuantity) / 2) || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyRafterInsulation&quot; name=&quot;applyRafterInsulationGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'RafterInsulation',</span>
                                 <span class="s0">improvementCosts.RafterInsulation * roofInsulationQuantity,</span>
                                 <span class="s0">availableGrants.RafterGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyRafterInsulation&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/&gt;</span>
            <span class="s0">)}</span>
            <span class="s0">{selectedUValues.UValueFloor &amp;&amp; (</span>
                <span class="s0">&lt;&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Floor Insulation&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{floorInsulationQuantity} m&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.FloorInsulation * floorInsulationQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.FloorGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.min(availableGrants.FloorGrant, (improvementCosts.FloorInsulation * floorInsulationQuantity) / 2 || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.FloorInsulation * floorInsulationQuantity) - Math.min(availableGrants.FloorGrant, (improvementCosts.FloorInsulation * floorInsulationQuantity) / 2) || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyFloorInsulation&quot; name=&quot;applyFloorInsulationGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'FloorInsulation',</span>
                                 <span class="s0">improvementCosts.FloorInsulation * floorInsulationQuantity,</span>
                                 <span class="s0">availableGrants.FloorGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyFloorInsulation&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/&gt;</span>
            <span class="s0">)}</span>
            <span class="s0">{selectedUValues.UValueWindow &amp;&amp; (</span>
                <span class="s0">&lt;&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Windows Upgrade&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;select</span>
                          <span class="s0">value={windowQuantity}</span>
                          <span class="s0">onChange={e =&gt; setWindowQuantity(Math.max(1, Math.min(50, parseInt(e.target.value, 10))))}</span>
                      <span class="s0">&gt;</span>
                        <span class="s0">{Array.from({ length: 50 }, (_, i) =&gt; (</span>
                            <span class="s0">&lt;option key={i + 1} value={i + 1}&gt;</span>
                              <span class="s0">{i + 1}</span>
                            <span class="s0">&lt;/option&gt;</span>
                        <span class="s0">))}</span>
                      <span class="s0">&lt;/select&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.WindowReplacement * windowQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.WindowGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.min(availableGrants.WindowGrant, (improvementCosts.WindowReplacement * windowQuantity) / 2 || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.WindowReplacement * windowQuantity) - Math.min(availableGrants.WindowGrant, (improvementCosts.WindowReplacement * windowQuantity) / 2) || 0).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyWindowReplacement&quot; name=&quot;applyWindowReplacementGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'WindowReplacement',</span>
                                 <span class="s0">improvementCosts.WindowReplacement * windowQuantity,</span>
                                 <span class="s0">availableGrants.WindowGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyWindowReplacement&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/&gt;</span>
            <span class="s0">)}</span>
            <span class="s0">{selectedUValues.UvalueDoor &amp;&amp; (</span>
                <span class="s0">&lt;&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;External Back Door Upgrade&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;select</span>
                          <span class="s0">value={BackDoorQuantity}</span>
                          <span class="s0">onChange={e =&gt; setBackDoorQuantity(Math.max(1, Math.min(5, parseInt(e.target.value, 10))))}</span>
                      <span class="s0">&gt;</span>
                        <span class="s0">{Array.from({ length: 5 }, (_, i) =&gt; (</span>
                            <span class="s0">&lt;option key={i + 1} value={i + 1}&gt;</span>
                              <span class="s0">{i + 1}</span>
                            <span class="s0">&lt;/option&gt;</span>
                        <span class="s0">))}</span>
                      <span class="s0">&lt;/select&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.BackDoorReplacement * BackDoorQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.BackDoorGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.BackDoorGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.BackDoorReplacement * BackDoorQuantity) - availableGrants.BackDoorGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyBackDoorReplacement&quot; name=&quot;applyBackDoorReplacementGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'BackDoorReplacement',</span>
                                 <span class="s0">improvementCosts.BackDoorReplacement * BackDoorQuantity,</span>
                                 <span class="s0">availableGrants.BackDoorGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyBackDoorReplacement&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;External Front Door Upgrade&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;select</span>
                          <span class="s0">value={FrontDoorQuantity}</span>
                          <span class="s0">onChange={e =&gt; setFrontDoorQuantity(Math.max(1, Math.min(5, parseInt(e.target.value, 10))))}</span>
                      <span class="s0">&gt;</span>
                        <span class="s0">{Array.from({ length: 5 }, (_, i) =&gt; (</span>
                            <span class="s0">&lt;option key={i + 1} value={i + 1}&gt;</span>
                              <span class="s0">{i + 1}</span>
                            <span class="s0">&lt;/option&gt;</span>
                        <span class="s0">))}</span>
                      <span class="s0">&lt;/select&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.FrontDoorReplacement * FrontDoorQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.FrontDoorGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.FrontDoorGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.FrontDoorReplacement * FrontDoorQuantity) - availableGrants.FrontDoorGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyFrontDoorReplacement&quot; name=&quot;applyFrontDoorReplacementGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'FrontDoorReplacement',</span>
                                 <span class="s0">improvementCosts.FrontDoorReplacement * FrontDoorQuantity,</span>
                                 <span class="s0">availableGrants.FrontDoorGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyFrontDoorReplacement&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/&gt;</span>
            <span class="s0">)}</span>
            <span class="s0">{selectedUValues.SolarPanels &amp;&amp; (</span>
                <span class="s0">&lt;&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Solar Panels (incl. Inverter and Batteries)&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{SolarPanelQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.SolarPanels).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.SolarPanelsGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.SolarPanelsGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.SolarPanels - availableGrants.SolarPanelsGrant)).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applySolarPanels&quot; name=&quot;applySolarPanelsGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'SolarPanels',</span>
                                 <span class="s0">improvementCosts.SolarPanels,</span>
                                 <span class="s0">availableGrants.SolarPanelsGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applySolarPanels&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Solar Hot Water&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{SolarHotWaterQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.SolarHotWater * SolarHotWaterQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.SolarHotWaterGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.SolarHotWaterGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.SolarHotWater * SolarHotWaterQuantity) - availableGrants.SolarHotWaterGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applySolarHotWater&quot; name=&quot;applySolarHotWaterGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'SolarHotWater',</span>
                                 <span class="s0">improvementCosts.SolarHotWater * SolarHotWaterQuantity,</span>
                                 <span class="s0">availableGrants.SolarHotWaterGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applySolarHotWater&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/&gt;</span>
            <span class="s0">)}</span>
            <span class="s0">{selectedUValues.HeatPump &amp;&amp; (</span>
                <span class="s0">&lt;&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Air to Water Heat Pump System&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{HeatPumpQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.HeatPumpAirToWater * HeatPumpQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpAirToWaterGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpAirToWaterGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.HeatPumpAirToWater * HeatPumpQuantity) - availableGrants.HeatPumpAirToWaterGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyHeatPumpAirToWater&quot; name=&quot;applyHeatPumpAirToWaterGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'HeatPumpAirToWater',</span>
                                 <span class="s0">improvementCosts.HeatPumpAirToWater * HeatPumpQuantity,</span>
                                 <span class="s0">availableGrants.HeatPumpAirToWaterGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyHeatPumpAirToWater&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Ground Source Heat Pump System&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{HeatPumpQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.HeatPumpGroundSource * HeatPumpQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpGroundSourceGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpGroundSourceGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.HeatPumpGroundSource * HeatPumpQuantity) - availableGrants.HeatPumpGroundSourceGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyHeatPumpGroundSource&quot; name=&quot;applyHeatPumpGroundSourceGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'HeatPumpGroundSource',</span>
                                 <span class="s0">improvementCosts.HeatPumpGroundSource * HeatPumpQuantity,</span>
                                 <span class="s0">availableGrants.HeatPumpGroundSourceGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyHeatPumpGroundSource&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Exhaust Air to Water Heat Pump System&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{HeatPumpQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.HeatPumpExhaustAir * HeatPumpQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpExhaustAirGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpExhaustAirGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.HeatPumpExhaustAir * HeatPumpQuantity) - availableGrants.HeatPumpExhaustAirGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyHeatPumpExhaustAir&quot; name=&quot;applyHeatPumpExhaustAirGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'HeatPumpExhaustAir',</span>
                                 <span class="s0">improvementCosts.HeatPumpExhaustAir * HeatPumpQuantity,</span>
                                 <span class="s0">availableGrants.HeatPumpExhaustAirGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyHeatPumpExhaustAir&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Water to Water Heat Pump System&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{HeatPumpQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.HeatPumpWaterToWater * HeatPumpQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpWaterToWaterGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpWaterToWaterGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.HeatPumpWaterToWater * HeatPumpQuantity) - availableGrants.HeatPumpWaterToWaterGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyHeatPumpWaterToWater&quot; name=&quot;applyHeatPumpWaterToWaterGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'HeatPumpWaterToWater',</span>
                                 <span class="s0">improvementCosts.HeatPumpWaterToWater * HeatPumpQuantity,</span>
                                 <span class="s0">availableGrants.HeatPumpWaterToWaterGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyHeatPumpWaterToWater&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Air to Air Heat Pump System&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{HeatPumpQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.HeatPumpAirToAir * HeatPumpQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpAirToAirGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatPumpAirToAirGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.HeatPumpAirToAir * HeatPumpQuantity) - availableGrants.HeatPumpAirToAirGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyHeatPumpAirToAir&quot; name=&quot;applyHeatPumpAirToAirGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'HeatPumpAirToAir',</span>
                                 <span class="s0">improvementCosts.HeatPumpAirToAir * HeatPumpQuantity,</span>
                                 <span class="s0">availableGrants.HeatPumpAirToAirGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyHeatPumpAirToAir&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Central Heating System for Heat Pump&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{CentralHeatingSystemQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.CentralHeatingSystem * CentralHeatingSystemQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.CentralHeatingSystemGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.CentralHeatingSystemGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.CentralHeatingSystemGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyCentralHeatingSystem&quot; name=&quot;applyCentralHeatingSystemGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'CentralHeatingSystem',</span>
                                 <span class="s0">improvementCosts.CentralHeatingSystem * CentralHeatingSystemQuantity,</span>
                                 <span class="s0">availableGrants.CentralHeatingSystemGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyCentralHeatingSystem&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;td&gt;Heating Controls&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{HeatingControlsQuantity}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{(improvementCosts.HeatingControls * HeatingControlsQuantity).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatingControlsGrant}*&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{availableGrants.HeatingControlsGrant.toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.HeatingControls * HeatingControlsQuantity) - availableGrants.HeatingControlsGrant).toFixed(2)}&lt;/td&gt;</span>
                    <span class="s0">&lt;td&gt;</span>
                      <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                        <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyHeatingControls&quot; name=&quot;applyHeatingControlsGrant&quot;</span>
                               <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                                 <span class="s0">'HeatingControls',</span>
                                 <span class="s0">improvementCosts.HeatingControls * HeatingControlsQuantity,</span>
                                 <span class="s0">availableGrants.HeatingControlsGrant)}</span>
                        <span class="s0">/&gt;</span>
                        <span class="s0">&lt;label htmlFor=&quot;applyHeatingControls&quot;&gt;Select&lt;/label&gt;</span>
                      <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/&gt;</span>
            <span class="s0">)}</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;td&gt;Mechanical Ventilation&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{MechanicalVentilationQuantity}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{(improvementCosts.MechanicalVentilation * MechanicalVentilationQuantity).toFixed(2)}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{availableGrants.MechanicalVentilationGrant}*&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{availableGrants.MechanicalVentilationGrant.toFixed(2)}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.MechanicalVentilation * MechanicalVentilationQuantity) - availableGrants.MechanicalVentilationGrant).toFixed(2)}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyMechanicalVentilation&quot; name=&quot;applyMechanicalVentilationGrant&quot;</span>
                         <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                           <span class="s0">'MechanicalVentilation',</span>
                           <span class="s0">improvementCosts.MechanicalVentilation * MechanicalVentilationQuantity,</span>
                           <span class="s0">availableGrants.MechanicalVentilationGrant)}</span>
                  <span class="s0">/&gt;</span>
                  <span class="s0">&lt;label htmlFor=&quot;applyMechanicalVentilation&quot;&gt;Select&lt;/label&gt;</span>
                <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;tr&gt;</span>
              <span class="s0">&lt;td&gt;Air Tightness&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{AirTightnessQuantity}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{(improvementCosts.AirTightness * AirTightnessQuantity).toFixed(2)}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{availableGrants.AirTightnessGrant}*&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{availableGrants.AirTightnessGrant.toFixed(2)}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{Math.max(0, (improvementCosts.AirTightness * AirTightnessQuantity) - availableGrants.AirTightnessGrant).toFixed(2)}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;</span>
                <span class="s0">&lt;div className=&quot;checkbox-container&quot;&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; id=&quot;applyAirTightness&quot; name=&quot;applyAirTightnessGrant&quot;</span>
                         <span class="s0">onChange={(e) =&gt; handleCheckboxChange(e,</span>
                           <span class="s0">'AirTightness',</span>
                           <span class="s0">improvementCosts.AirTightness * AirTightnessQuantity,</span>
                           <span class="s0">availableGrants.AirTightnessGrant)}</span>
                  <span class="s0">/&gt;</span>
                  <span class="s0">&lt;label htmlFor=&quot;applyAirTightness&quot;&gt;Select&lt;/label&gt;</span>
                <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;tr className=&quot;total-row&quot;&gt;</span>
              <span class="s0">&lt;td colSpan=&quot;2&quot;&gt;Total&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{totalEstimatedCost.toFixed(2)}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{totalAvailableGrant}&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{totalRecalculatedGrant.toFixed(2)}*&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;{totalCostToHomeowner.toFixed(2)}**&lt;/td&gt;</span>
              <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot; target=&quot;_blank&quot;</span>
                     <span class="s0">rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
            <span class="s0">&lt;/tr&gt;</span>
            <span class="s0">&lt;/tbody&gt;</span>
          <span class="s0">&lt;/table&gt;</span>
          <span class="s0">&lt;h3&gt;Disclaimer&lt;/h3&gt;</span>
          <span class="s0">&lt;p&gt;*Grants may be limited to only 50% of the total estimated cost for each improvement. &lt;br/&gt;&lt;br/&gt;</span>
            <span class="s0">**Total estimated cost to homeowner is based on the estimated works cost minus the total SEAI grants limited</span>
            <span class="s0">to 50% of the estimated works cost.</span>
            <span class="s0">However, this amount may be change, depending on the SEAI grants approved.</span>
          <span class="s0">&lt;/p&gt;</span>
        <span class="s0">&lt;/div&gt;</span>

      <span class="s0">&lt;/&gt;</span>
  <span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">export default SuggestionsPage;</span>





<span class="s0">Modified 20/03/2024, after adjustment to UseEffect and Walls</span>

<span class="s0">import React, { useState, useEffect } from 'react';</span>
<span class="s0">import { useLocation } from 'react-router-dom';</span>
<span class="s0">import Papa from 'papaparse';</span>

<span class="s0">function SuggestionsPage () {</span>
  <span class="s0">const location = useLocation();</span>
  <span class="s0">const selectedProperty = location.state ? location.state.selectedProperty : null;</span>
  <span class="s0">const selectedDwellingType = useState('');</span>
  <span class="s0">const [newEnergyRating, setNewEnergyRating] = useState('');</span>
  <span class="s0">const [archetypeData, setArchetypeData] = useState([]);</span>
  <span class="s0">const [seaiGrants, setSeaiGrants] = useState([]);</span>
  <span class="s0">const [modifiedValues, setModifiedValues] = useState({});</span>
  <span class="s0">const [selectedUValues, setSelectedUValues] = useState({});</span>
  <span class="s0">const [improvementEstimates, setImprovementEstimates] = useState({});</span>
  <span class="s0">const [wallInsulationQuantity, setWallInsulationQuantity] = useState(selectedProperty ? selectedProperty.WallArea : 0);</span>

  <span class="s0">const handleValueChange = (field, value) =&gt; {</span>
    <span class="s0">setModifiedValues(prev =&gt; ({ ...prev, [field]: value }));</span>
  <span class="s0">};</span>

  <span class="s0">const availableRatings = selectedProperty &amp;&amp; ['A1', 'A2', 'A3', 'B1', 'B2'].filter(rating =&gt; rating !== selectedProperty.EnergyRating &amp;&amp; rating &lt; selectedProperty.EnergyRating);</span>

  <span class="s0">const [thresholdValues, setThresholdValues] = useState({</span>
    <span class="s0">wall: 0, // Default values, will be updated dynamically</span>
    <span class="s0">roof: 0,</span>
    <span class="s0">floor: 0,</span>
    <span class="s0">window: 0,</span>
    <span class="s0">door: 0</span>
  <span class="s0">});</span>

  <span class="s0">const improvementCosts = {</span>
    <span class="s0">WallInternalInsulation: 0, // example costs in currency units</span>
    <span class="s0">WallExternalInsulation: 0,</span>
    <span class="s0">UValueRoof: 0,</span>
    <span class="s0">UValueFloor: 0,</span>
    <span class="s0">UValueWindow: 0,</span>
    <span class="s0">UValueDoor: 0</span>
  <span class="s0">};</span>

  <span class="s0">const availableGrants = {</span>
    <span class="s0">WallInternalGrant: 0, // example grant amounts in currency units</span>
    <span class="s0">WallExternalGrant: 0,</span>
    <span class="s0">UValueRoof: 0,</span>
    <span class="s0">UValueFloor: 0,</span>
    <span class="s0">UValueWindow: 0,</span>
    <span class="s0">UValueDoor: 0</span>
  <span class="s0">};</span>

  <span class="s0">const handleUValueChange = (e, field) =&gt; {</span>
    <span class="s0">setSelectedUValues({ ...selectedUValues, [field]: e.target.checked });</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewUValues = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewEnergyRating = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">useEffect(() =&gt; {</span>
    <span class="s0">// Scrolls the window to the top of the new page</span>
    <span class="s0">window.scrollTo(0, 0);</span>

    <span class="s0">// Set the initial wall insulation quantity based on the selected property</span>
    <span class="s0">if (selectedProperty &amp;&amp; selectedProperty.WallArea) {</span>
      <span class="s0">setWallInsulationQuantity(selectedProperty.WallArea);</span>
    <span class="s0">}</span>

    <span class="s0">// Define a function to fetch and parse the SEAI grants data</span>
    <span class="s0">const fetchSEAIgrants = async () =&gt; {</span>
      <span class="s0">const response = await fetch('/data/seai_grants.csv');</span>
      <span class="s0">const text = await response.text();</span>
      <span class="s0">return Papa.parse(text, { header: true, dynamicTyping: true }).data;</span>
    <span class="s0">};</span>

    <span class="s0">// Define a function to fetch and parse the building archetype data</span>
    <span class="s0">const fetchArchetypeData = async () =&gt; {</span>
      <span class="s0">const response = await fetch('/data/data_building_archetype.csv');</span>
      <span class="s0">const text = await response.text();</span>
      <span class="s0">return Papa.parse(text, { header: true, dynamicTyping: true }).data;</span>
    <span class="s0">};</span>
    <span class="s0">// Use Promise.all to fetch both datasets concurrently</span>
    <span class="s0">Promise.all([fetchSEAIgrants(), fetchArchetypeData()]).then(([seaiGrantsData, archetypeData]) =&gt; {</span>
      <span class="s0">setSeaiGrants(seaiGrantsData);</span>
      <span class="s0">setArchetypeData(archetypeData);</span>
    <span class="s0">});</span>

    <span class="s0">// Assuming selectedDwellingType holds type like 'Semi-detached house'</span>
    <span class="s0">const dwellingType = selectedProperty ? selectedProperty.DwellingTypeDescr : '';</span>
    <span class="s0">const newRating = newEnergyRating;</span>

    <span class="s0">// Find matching row for new energy rating and dwelling type from archetype data</span>
    <span class="s0">const matchedRow = archetypeData.find(row =&gt; row.DwellingType === dwellingType &amp;&amp; row.EnergyRating === newRating);</span>

    <span class="s0">// If a matching row is found, update the threshold values</span>
    <span class="s0">if (matchedRow) {</span>
      <span class="s0">setThresholdValues({</span>
        <span class="s0">wall: matchedRow.UValueWallMean,</span>
        <span class="s0">roof: matchedRow.UValueRoofMean,</span>
        <span class="s0">floor: matchedRow.UValueFloorMean,</span>
        <span class="s0">window: matchedRow.UValueWindowMean,</span>
        <span class="s0">door: matchedRow.UValueDoorMean</span>
      <span class="s0">});</span>
    <span class="s0">}</span>

    <span class="s0">// Update improvement costs and available grants based on SEAI grants data and dwelling type</span>
    <span class="s0">const updatedImprovementCosts = { ...improvementCosts }; // Make a copy of current state</span>
    <span class="s0">const updatedAvailableGrants = { ...availableGrants }; // Make a copy of current state</span>

    <span class="s0">seaiGrantsData.forEach(grant =&gt; {</span>
      <span class="s0">if (grant.DwellingTypes === dwellingType) {</span>
        <span class="s0">switch (grant['Grant name']) {</span>
          <span class="s0">case 'Internal Wall Insulation':</span>
            <span class="s0">updatedImprovementCosts.WallInternalInsulation = grant.EstimatedImprovementCost;</span>
            <span class="s0">updatedAvailableGrants.WallInternalGrant = grant.GrantValue;</span>
            <span class="s0">break;</span>
          <span class="s0">case 'External Wall Insulation':</span>
            <span class="s0">updatedImprovementCosts.WallExternalInsulation = grant.EstimatedImprovementCost;</span>
            <span class="s0">updatedAvailableGrants.WallExternalGrant = grant.GrantValue;</span>
            <span class="s0">break;</span>
            <span class="s0">// Add cases for other types of insulation or improvements</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">});</span>

    <span class="s0">// Call the data fetching functions</span>
    <span class="s0">fetchArchetypeData();</span>
    <span class="s0">fetchSEAIgrants();</span>
  <span class="s0">}, [selectedProperty, newEnergyRating]); // Ensure useEffect is triggered when these values change</span>

  <span class="s0">// Display the selected property and inputs for modifying U-values</span>
  <span class="s0">return (</span>
      <span class="s0">&lt;div&gt;</span>
        <span class="s0">&lt;h1&gt;Selected Property&lt;/h1&gt;</span>
        <span class="s0">{selectedProperty &amp;&amp; (</span>
            <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
              <span class="s0">&lt;p&gt;&lt;strong&gt;Dwelling Type:&lt;/strong&gt; {selectedProperty.DwellingTypeDescr}&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;&lt;strong&gt;Current Energy Rating:&lt;/strong&gt; {selectedProperty.EnergyRating}&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;&lt;/p&gt;</span>
              <span class="s0">&lt;h2&gt;Select New Energy Rating&lt;/h2&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">Choosing a new Energy Rating for your home is a proactive step towards enhancing your living</span>
                <span class="s0">environment and reducing your energy costs.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">A higher Energy Rating signifies better thermal efficiency, meaning your home retains heat more</span>
                <span class="s0">effectively during winter and stays cooler during summer.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">This not only improves comfort but also reduces the need for excessive heating or</span>
                <span class="s0">cooling, leading to significant savings on energy bills.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">Additionally, upgrading your home&amp;apos;s energy performance can increase its market</span>
                <span class="s0">value and reduce its environmental impact by lowering carbon emissions.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">Select a new Energy Rating below to see how you can achieve these benefits.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;select value={newEnergyRating} onChange={e =&gt; setNewEnergyRating(e.target.value)}&gt;</span>
                <span class="s0">&lt;option value=&quot;&quot;&gt;Select New Energy Rating&lt;/option&gt;</span>
                <span class="s0">{availableRatings &amp;&amp; availableRatings.map(rating =&gt; &lt;option key={rating}</span>
                                                                            <span class="s0">value={rating}&gt;{rating}&lt;/option&gt;)}</span>
              <span class="s0">&lt;/select&gt;</span>
              <span class="s0">&lt;button onClick={submitNewEnergyRating} className=&quot;button-blue&quot;&gt;Submit&lt;/button&gt;</span>
              <span class="s0">&lt;h2&gt;Current U-Values&lt;/h2&gt;</span>
              <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                <span class="s0">&lt;thead&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;U-Value Types&lt;/th&gt;</span>
                  <span class="s0">&lt;th&gt;Target U-Values&lt;/th&gt;</span>
                  <span class="s0">&lt;th&gt;Existing U-Values&lt;/th&gt;</span>
                  <span class="s0">&lt;th&gt;Description&lt;/th&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/thead&gt;</span>
                <span class="s0">&lt;tbody&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Walls UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.wall}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueWall}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01</span>
                      <span class="s0">? 'Your walls are not holding heat well. Consider upgrading insulation.'</span>
                      <span class="s0">: selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01</span>
                        <span class="s0">? 'Your walls are well insulated against heat loss.'</span>
                        <span class="s0">: 'Your walls meet the minimum standard, but improvements could still be beneficial.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Roof UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.roof}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueRoof - thresholdValues.roof &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueRoof - thresholdValues.roof &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueRoof}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UValueRoof - thresholdValues.roof &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueRoof - thresholdValues.roof &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueRoof &gt; thresholdValues.roof</span>
                      <span class="s0">? 'Heat is escaping through your roof. Consider upgrading insulation.'</span>
                      <span class="s0">: selectedProperty.UValueRoof === thresholdValues.roof</span>
                        <span class="s0">? 'Your roof meets the minimum standard, but improvements could still be beneficial.'</span>
                        <span class="s0">: 'Your roof is well insulated against heat loss.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Floors UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.floor}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueFloor - thresholdValues.floor &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueFloor - thresholdValues.floor &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueFloor}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UValueFloor - thresholdValues.floor &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueFloor - thresholdValues.floor &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueFloor &gt; thresholdValues.floor</span>
                      <span class="s0">? 'Your floors are losing heat, consider improving insulation.'</span>
                      <span class="s0">: selectedProperty.UValueFloor === thresholdValues.floor</span>
                        <span class="s0">? 'Your floors meet the standard, but consider enhancements for better warmth.'</span>
                        <span class="s0">: 'Your floors are retaining heat efficiently.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Windows UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.window}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueWindow - thresholdValues.window &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWindow - thresholdValues.window &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueWindow}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UValueWindow - thresholdValues.window &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWindow - thresholdValues.window &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueWindow &gt; thresholdValues.window</span>
                      <span class="s0">? 'Your windows are not keeping heat in effectively. Consider updating them.'</span>
                      <span class="s0">: selectedProperty.UValueWindow === thresholdValues.window</span>
                        <span class="s0">? 'Your windows are adequate, but newer models could offer more savings.'</span>
                        <span class="s0">: 'Your windows are performing well in retaining heat.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Doors UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.door}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UvalueDoor - thresholdValues.door &gt; 0.01 ? 'u-value-high' : selectedProperty.UvalueDoor - thresholdValues.door &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UvalueDoor}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UvalueDoor - thresholdValues.door &gt; 0.01 ? 'u-value-high' : selectedProperty.UvalueDoor - thresholdValues.door &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UvalueDoor &gt; thresholdValues.door</span>
                      <span class="s0">? 'Your doors are not insulating well. Consider replacements or sealing gaps.'</span>
                      <span class="s0">: selectedProperty.UvalueDoor === thresholdValues.door</span>
                        <span class="s0">? 'Your doors meet the current standard, yet there might be room for improvement.'</span>
                        <span class="s0">: 'Your doors are well-sealed and insulated.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/tbody&gt;</span>
              <span class="s0">&lt;/table&gt;</span>
              <span class="s0">&lt;h2&gt;Select U-Values to Modify&lt;/h2&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWall}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWall')}/&gt;</span>
                  <span class="s0">Wall</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueRoof}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueRoof')}/&gt;</span>
                  <span class="s0">Roof</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueFloor}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueFloor')}/&gt;</span>
                  <span class="s0">Floor</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWindow}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWindow')}/&gt;</span>
                  <span class="s0">Window</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueDoor}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueDoor')}/&gt;</span>
                  <span class="s0">Door</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;h2&gt;Select optional items to install&lt;/h2&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input</span>
                      <span class="s0">type=&quot;checkbox&quot;</span>
                      <span class="s0">checked={!!selectedUValues.SolarPanels}</span>
                      <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'SolarPanels')}</span>
                  <span class="s0">/&gt;</span>
                  <span class="s0">Solar Panels</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input</span>
                      <span class="s0">type=&quot;checkbox&quot;</span>
                      <span class="s0">checked={!!selectedUValues.HeatPump}</span>
                      <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'HeatPump')}</span>
                  <span class="s0">/&gt;</span>
                  <span class="s0">Heat Pump</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>

              <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
                <span class="s0">&lt;h2&gt;Improvement Estimates&lt;/h2&gt;</span>
                <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                  <span class="s0">&lt;thead&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;th&gt;Improvement&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Quantity&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Estimated Works Cost&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Available SEAI Grant&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Estimated Cost to Homeowner&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Apply for Grant&lt;/th&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;/thead&gt;</span>
                  <span class="s0">&lt;tbody&gt;</span>
                  <span class="s0">{selectedUValues.UValueWall &amp;&amp; (</span>
                      <span class="s0">&lt;&gt;</span>
                        <span class="s0">&lt;tr&gt;</span>
                          <span class="s0">&lt;td&gt;Internal Wall Insulation&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;{wallInsulationQuantity} m&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;{improvementCosts.WallInternalInsulation * wallInsulationQuantity}&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;{availableGrants.WallInternalGrant}&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;{(improvementCosts.WallInternalInsulation * wallInsulationQuantity) - availableGrants.WallInternalGrant}&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot; target=&quot;_blank&quot;</span>
                                 <span class="s0">rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                        <span class="s0">&lt;/tr&gt;</span>
                        <span class="s0">&lt;tr&gt;</span>
                          <span class="s0">&lt;td&gt;External Wall Insulation&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;16,000&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;8,000&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;8,000&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                 <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                        <span class="s0">&lt;/tr&gt;</span>
                        <span class="s0">&lt;tr&gt;</span>
                          <span class="s0">&lt;td&gt;Cavity Wall Insulation&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;2,200&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;1,700&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;500&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                 <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                        <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">&lt;/&gt;</span>
                  <span class="s0">)}</span>
                  <span class="s0">{selectedUValues.UValueRoof &amp;&amp; (</span>
                      <span class="s0">&lt;tr&gt;</span>
                        <span class="s0">&lt;td&gt;Roof/Attic Insulation&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;2,000&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;1,500&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;500&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                               <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                      <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">)}</span>
                  <span class="s0">{/* Repeat similar structures for UValueFloor, UValueWindow, UValueDoor if necessary */}</span>
                  <span class="s0">&lt;/tbody&gt;</span>
                <span class="s0">&lt;/table&gt;</span>
                <span class="s0">{/* You can add additional instructions or information below the table */}</span>
              <span class="s0">&lt;/div&gt;</span>

            <span class="s0">&lt;/div&gt;</span>
        <span class="s0">)}</span>
      <span class="s0">&lt;/div&gt;</span>
  <span class="s0">);</span>
<span class="s0">}</span>
<span class="s0">export default SuggestionsPage;</span>


<span class="s0">Modified 20/03/2024, before adjustment to UseEffect</span>

<span class="s0">import React, { useState, useEffect } from 'react';</span>
<span class="s0">import { useLocation } from 'react-router-dom';</span>
<span class="s0">import Papa from 'papaparse';</span>

<span class="s0">function SuggestionsPage () {</span>
  <span class="s0">const location = useLocation();</span>
  <span class="s0">const selectedProperty = location.state ? location.state.selectedProperty : null;</span>
  <span class="s0">const selectedDwellingType = useState('');</span>
  <span class="s0">const [newEnergyRating, setNewEnergyRating] = useState('');</span>
  <span class="s0">const [archetypeData, setArchetypeData] = useState([]);</span>
  <span class="s0">const [modifiedValues, setModifiedValues] = useState({});</span>
  <span class="s0">const [selectedUValues, setSelectedUValues] = useState({});</span>

  <span class="s0">const handleValueChange = (field, value) =&gt; {</span>
    <span class="s0">setModifiedValues(prev =&gt; ({ ...prev, [field]: value }));</span>
  <span class="s0">};</span>

  <span class="s0">const availableRatings = selectedProperty &amp;&amp; ['A1', 'A2', 'A3', 'B1', 'B2'].filter(rating =&gt; rating !== selectedProperty.EnergyRating &amp;&amp; rating &lt; selectedProperty.EnergyRating);</span>

  <span class="s0">const [thresholdValues, setThresholdValues] = useState({</span>
    <span class="s0">wall: 0, // Default values, will be updated dynamically</span>
    <span class="s0">roof: 0,</span>
    <span class="s0">floor: 0,</span>
    <span class="s0">window: 0,</span>
    <span class="s0">door: 0</span>
  <span class="s0">});</span>

  <span class="s0">const improvementCosts = {</span>
    <span class="s0">UValueWall: 5000, // example costs in currency units</span>
    <span class="s0">UValueRoof: 4000,</span>
    <span class="s0">UValueFloor: 3000,</span>
    <span class="s0">UValueWindow: 2000,</span>
    <span class="s0">UValueDoor: 1000</span>
  <span class="s0">};</span>

  <span class="s0">const availableGrants = {</span>
    <span class="s0">UValueWall: 2000, // example grant amounts in currency units</span>
    <span class="s0">UValueRoof: 1500,</span>
    <span class="s0">UValueFloor: 1000,</span>
    <span class="s0">UValueWindow: 500,</span>
    <span class="s0">UValueDoor: 250</span>
  <span class="s0">};</span>

  <span class="s0">const handleUValueChange = (e, field) =&gt; {</span>
    <span class="s0">setSelectedUValues({ ...selectedUValues, [field]: e.target.checked });</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewUValues = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewEnergyRating = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">useEffect(() =&gt; {</span>
    <span class="s0">// Scrolls the window to the top of the new page</span>
    <span class="s0">window.scrollTo(0, 0);</span>

    <span class="s0">// Fetch archetype data once at the start or when the selected property changes</span>
    <span class="s0">fetch('/data/data_building_archetype.csv')</span>
      <span class="s0">.then(response =&gt; response.text())</span>
      <span class="s0">.then(text =&gt; {</span>
        <span class="s0">Papa.parse(text, {</span>
          <span class="s0">header: true,</span>
          <span class="s0">complete: result =&gt; {</span>
            <span class="s0">// Set the full dataset (if you need to use it elsewhere)</span>
            <span class="s0">setArchetypeData(result.data);</span>

            <span class="s0">// Assuming selectedDwellingType holds type like 'Semi-detached house'</span>
            <span class="s0">const dwellingType = selectedProperty ? selectedProperty.DwellingTypeDescr : '';</span>
            <span class="s0">const newRating = newEnergyRating;</span>

            <span class="s0">// Find matching row for new energy rating and dwelling type</span>
            <span class="s0">const matchedRow = result.data.find(row =&gt;</span>
              <span class="s0">row.DwellingType === dwellingType &amp;&amp; row.EnergyRating === newRating);</span>

            <span class="s0">// If a matching row is found, update the threshold values</span>
            <span class="s0">if (matchedRow) {</span>
              <span class="s0">setThresholdValues({</span>
                <span class="s0">wall: parseFloat(matchedRow.UValueWallMean),</span>
                <span class="s0">roof: parseFloat(matchedRow.UValueRoofMean),</span>
                <span class="s0">floor: parseFloat(matchedRow.UValueFloorMean),</span>
                <span class="s0">window: parseFloat(matchedRow.UValueWindowMean),</span>
                <span class="s0">door: parseFloat(matchedRow.UValueDoorMean)</span>
              <span class="s0">});</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
        <span class="s0">});</span>
      <span class="s0">});</span>
  <span class="s0">}, [selectedProperty, newEnergyRating]); // Ensure useEffect is triggered when these values change</span>

  <span class="s0">// Display the selected property and inputs for modifying U-values</span>
  <span class="s0">return (</span>
      <span class="s0">&lt;div&gt;</span>
        <span class="s0">&lt;h1&gt;Selected Property&lt;/h1&gt;</span>
        <span class="s0">{selectedProperty &amp;&amp; (</span>
            <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
              <span class="s0">&lt;p&gt;&lt;strong&gt;Dwelling Type:&lt;/strong&gt; {selectedProperty.DwellingTypeDescr}&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;&lt;strong&gt;Current Energy Rating:&lt;/strong&gt; {selectedProperty.EnergyRating}&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;&lt;/p&gt;</span>
              <span class="s0">&lt;h2&gt;Select New Energy Rating&lt;/h2&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">Choosing a new Energy Rating for your home is a proactive step towards enhancing your living</span>
                <span class="s0">environment and reducing your energy costs.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">A higher Energy Rating signifies better thermal efficiency, meaning your home retains heat more</span>
                <span class="s0">effectively during winter and stays cooler during summer.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">This not only improves comfort but also reduces the need for excessive heating or</span>
                <span class="s0">cooling, leading to significant savings on energy bills.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">Additionally, upgrading your home&amp;apos;s energy performance can increase its market</span>
                <span class="s0">value and reduce its environmental impact by lowering carbon emissions.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;p&gt;</span>
                <span class="s0">Select a new Energy Rating below to see how you can achieve these benefits.</span>
              <span class="s0">&lt;/p&gt;</span>
              <span class="s0">&lt;select value={newEnergyRating} onChange={e =&gt; setNewEnergyRating(e.target.value)}&gt;</span>
                <span class="s0">&lt;option value=&quot;&quot;&gt;Select New Energy Rating&lt;/option&gt;</span>
                <span class="s0">{availableRatings &amp;&amp; availableRatings.map(rating =&gt; &lt;option key={rating}</span>
                                                                            <span class="s0">value={rating}&gt;{rating}&lt;/option&gt;)}</span>
              <span class="s0">&lt;/select&gt;</span>
              <span class="s0">&lt;button onClick={submitNewEnergyRating} className=&quot;button-blue&quot;&gt;Submit&lt;/button&gt;</span>
              <span class="s0">&lt;h2&gt;Current U-Values&lt;/h2&gt;</span>
              <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                <span class="s0">&lt;thead&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;U-Value Types&lt;/th&gt;</span>
                  <span class="s0">&lt;th&gt;Target U-Values&lt;/th&gt;</span>
                  <span class="s0">&lt;th&gt;Existing U-Values&lt;/th&gt;</span>
                  <span class="s0">&lt;th&gt;Description&lt;/th&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/thead&gt;</span>
                <span class="s0">&lt;tbody&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Walls UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.wall}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueWall}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01</span>
                      <span class="s0">? 'Your walls are not holding heat well. Consider upgrading insulation.'</span>
                      <span class="s0">: selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01</span>
                        <span class="s0">? 'Your walls are well insulated against heat loss.'</span>
                        <span class="s0">: 'Your walls meet the minimum standard, but improvements could still be beneficial.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Roof UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.roof}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueRoof - thresholdValues.roof &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueRoof - thresholdValues.roof &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueRoof}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UValueRoof - thresholdValues.roof &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueRoof - thresholdValues.roof &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueRoof &gt; thresholdValues.roof</span>
                      <span class="s0">? 'Heat is escaping through your roof. Consider upgrading insulation.'</span>
                      <span class="s0">: selectedProperty.UValueRoof === thresholdValues.roof</span>
                        <span class="s0">? 'Your roof meets the minimum standard, but improvements could still be beneficial.'</span>
                        <span class="s0">: 'Your roof is well insulated against heat loss.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Floors UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.floor}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueFloor - thresholdValues.floor &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueFloor - thresholdValues.floor &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueFloor}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UValueFloor - thresholdValues.floor &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueFloor - thresholdValues.floor &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueFloor &gt; thresholdValues.floor</span>
                      <span class="s0">? 'Your floors are losing heat, consider improving insulation.'</span>
                      <span class="s0">: selectedProperty.UValueFloor === thresholdValues.floor</span>
                        <span class="s0">? 'Your floors meet the standard, but consider enhancements for better warmth.'</span>
                        <span class="s0">: 'Your floors are retaining heat efficiently.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Windows UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.window}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueWindow - thresholdValues.window &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWindow - thresholdValues.window &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueWindow}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UValueWindow - thresholdValues.window &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWindow - thresholdValues.window &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UValueWindow &gt; thresholdValues.window</span>
                      <span class="s0">? 'Your windows are not keeping heat in effectively. Consider updating them.'</span>
                      <span class="s0">: selectedProperty.UValueWindow === thresholdValues.window</span>
                        <span class="s0">? 'Your windows are adequate, but newer models could offer more savings.'</span>
                        <span class="s0">: 'Your windows are performing well in retaining heat.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                  <span class="s0">&lt;th&gt;Doors UValue&lt;/th&gt;</span>
                  <span class="s0">&lt;td&gt;{thresholdValues.door}&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`value-cell ${selectedProperty.UvalueDoor - thresholdValues.door &gt; 0.01 ? 'u-value-high' : selectedProperty.UvalueDoor - thresholdValues.door &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UvalueDoor}</span>
                  <span class="s0">&lt;/td&gt;</span>
                  <span class="s0">&lt;td className={`${selectedProperty.UvalueDoor - thresholdValues.door &gt; 0.01 ? 'u-value-high' : selectedProperty.UvalueDoor - thresholdValues.door &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                    <span class="s0">{selectedProperty.UvalueDoor &gt; thresholdValues.door</span>
                      <span class="s0">? 'Your doors are not insulating well. Consider replacements or sealing gaps.'</span>
                      <span class="s0">: selectedProperty.UvalueDoor === thresholdValues.door</span>
                        <span class="s0">? 'Your doors meet the current standard, yet there might be room for improvement.'</span>
                        <span class="s0">: 'Your doors are well-sealed and insulated.'}</span>
                  <span class="s0">&lt;/td&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/tbody&gt;</span>
              <span class="s0">&lt;/table&gt;</span>
              <span class="s0">&lt;h2&gt;Select U-Values to Modify&lt;/h2&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWall}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWall')}/&gt;</span>
                  <span class="s0">Wall</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueRoof}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueRoof')}/&gt;</span>
                  <span class="s0">Roof</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueFloor}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueFloor')}/&gt;</span>
                  <span class="s0">Floor</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWindow}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWindow')}/&gt;</span>
                  <span class="s0">Window</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueDoor}</span>
                         <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueDoor')}/&gt;</span>
                  <span class="s0">Door</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;h2&gt;Select optional items to install&lt;/h2&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input</span>
                      <span class="s0">type=&quot;checkbox&quot;</span>
                      <span class="s0">checked={!!selectedUValues.SolarPanels}</span>
                      <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'SolarPanels')}</span>
                  <span class="s0">/&gt;</span>
                  <span class="s0">Solar Panels</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>
              <span class="s0">&lt;div&gt;</span>
                <span class="s0">&lt;label&gt;</span>
                  <span class="s0">&lt;input</span>
                      <span class="s0">type=&quot;checkbox&quot;</span>
                      <span class="s0">checked={!!selectedUValues.HeatPump}</span>
                      <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'HeatPump')}</span>
                  <span class="s0">/&gt;</span>
                  <span class="s0">Heat Pump</span>
                <span class="s0">&lt;/label&gt;</span>
              <span class="s0">&lt;/div&gt;</span>

              <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
                <span class="s0">&lt;h2&gt;Improvement Estimates&lt;/h2&gt;</span>
                <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                  <span class="s0">&lt;thead&gt;</span>
                  <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;th&gt;Improvement&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Estimated Works Cost&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Available SEAI Grant&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Estimated Cost to Homeowner&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Apply for Grant&lt;/th&gt;</span>
                  <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">&lt;/thead&gt;</span>
                  <span class="s0">&lt;tbody&gt;</span>
                  <span class="s0">{selectedUValues.UValueWall &amp;&amp; (</span>
                      <span class="s0">&lt;&gt;</span>
                        <span class="s0">&lt;tr&gt;</span>
                          <span class="s0">&lt;td&gt;Internal Wall Insulation&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;9,000&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;4,500&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;4,500&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                 <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                        <span class="s0">&lt;/tr&gt;</span>
                        <span class="s0">&lt;tr&gt;</span>
                          <span class="s0">&lt;td&gt;External Wall Insulation&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;16,000&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;8,000&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;8,000&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                 <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                        <span class="s0">&lt;/tr&gt;</span>
                        <span class="s0">&lt;tr&gt;</span>
                          <span class="s0">&lt;td&gt;Cavity Wall Insulation&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;2,200&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;1,700&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;500&lt;/td&gt;</span>
                          <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                 <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                        <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">&lt;/&gt;</span>
                  <span class="s0">)}</span>
                  <span class="s0">{selectedUValues.UValueRoof &amp;&amp; (</span>
                      <span class="s0">&lt;tr&gt;</span>
                        <span class="s0">&lt;td&gt;Roof/Attic Insulation&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;2,000&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;1,500&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;500&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                               <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                      <span class="s0">&lt;/tr&gt;</span>
                  <span class="s0">)}</span>
                  <span class="s0">{/* Repeat similar structures for UValueFloor, UValueWindow, UValueDoor if necessary */}</span>
                  <span class="s0">&lt;/tbody&gt;</span>
                <span class="s0">&lt;/table&gt;</span>
                <span class="s0">{/* You can add additional instructions or information below the table */}</span>
              <span class="s0">&lt;/div&gt;</span>

            <span class="s0">&lt;/div&gt;</span>
        <span class="s0">)}</span>
      <span class="s0">&lt;/div&gt;</span>
  <span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">export default SuggestionsPage;</span>


<span class="s0">Modified 19/03/2024, but with an infinite loop for seai_grants</span>

<span class="s0">import React, { useState, useEffect } from 'react';</span>
<span class="s0">import { useLocation } from 'react-router-dom';</span>
<span class="s0">import Papa from 'papaparse';</span>

<span class="s0">function SuggestionsPage () {</span>
  <span class="s0">const location = useLocation();</span>
  <span class="s0">const selectedProperty = location.state ? location.state.selectedProperty : null;</span>
  <span class="s0">const selectedDwellingType = useState('');</span>
  <span class="s0">const [newEnergyRating, setNewEnergyRating] = useState('');</span>
  <span class="s0">const [archetypeData, setArchetypeData] = useState([]);</span>
  <span class="s0">const [modifiedValues, setModifiedValues] = useState({});</span>
  <span class="s0">const [selectedUValues, setSelectedUValues] = useState({});</span>

  <span class="s0">const handleValueChange = (field, value) =&gt; {</span>
    <span class="s0">setModifiedValues(prev =&gt; ({ ...prev, [field]: value }));</span>
  <span class="s0">};</span>

  <span class="s0">const availableRatings = selectedProperty &amp;&amp; ['A1', 'A2', 'A3', 'B1', 'B2'].filter(rating =&gt; rating !== selectedProperty.EnergyRating &amp;&amp; rating &lt; selectedProperty.EnergyRating);</span>

  <span class="s0">const [thresholdValues, setThresholdValues] = useState({</span>
    <span class="s0">wall: 0, // Default values, will be updated dynamically</span>
    <span class="s0">roof: 0,</span>
    <span class="s0">floor: 0,</span>
    <span class="s0">window: 0,</span>
    <span class="s0">door: 0</span>
  <span class="s0">});</span>

  <span class="s0">const [improvementEstimates, setImprovementEstimates] = useState({});</span>

  <span class="s0">const [seaiGrants, setSeaiGrants] = useState([]);</span>

  <span class="s0">const handleUValueChange = (e, field) =&gt; {</span>
    <span class="s0">setSelectedUValues({ ...selectedUValues, [field]: e.target.checked });</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewUValues = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewEnergyRating = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">useEffect(() =&gt; {</span>
    <span class="s0">// Scrolls the window to the top of the new page</span>
    <span class="s0">window.scrollTo(0, 0);</span>

    <span class="s0">// Fetch SEAI grants data</span>
    <span class="s0">fetch('/data/seai_grants.csv')</span>
      <span class="s0">.then(response =&gt; response.text())</span>
      <span class="s0">.then(text =&gt; {</span>
        <span class="s0">Papa.parse(text, {</span>
          <span class="s0">header: true,</span>
          <span class="s0">complete: (result) =&gt; {</span>
            <span class="s0">setSeaiGrants(result.data);</span>
          <span class="s0">}</span>
        <span class="s0">});</span>
      <span class="s0">});</span>

    <span class="s0">// Fetch archetype data once at the start or when the selected property changes</span>
    <span class="s0">fetch('/data/data_building_archetype.csv')</span>
      <span class="s0">.then(response =&gt; response.text())</span>
      <span class="s0">.then(text =&gt; {</span>
        <span class="s0">Papa.parse(text, {</span>
          <span class="s0">header: true,</span>
          <span class="s0">complete: result =&gt; {</span>
            <span class="s0">// Set the full dataset (if you need to use it elsewhere)</span>
            <span class="s0">setArchetypeData(result.data);</span>

            <span class="s0">// Assuming selectedDwellingType holds type like 'Semi-detached house'</span>
            <span class="s0">const dwellingType = selectedProperty ? selectedProperty.DwellingTypeDescr : '';</span>
            <span class="s0">const newRating = newEnergyRating;</span>
            <span class="s0">const areaMappings = {</span>
              <span class="s0">UValueWall: selectedProperty ? selectedProperty.WallArea : 0,</span>
              <span class="s0">UValueRoof: selectedProperty ? selectedProperty.RoofArea : 0,</span>
              <span class="s0">UValueFloor: selectedProperty ? selectedProperty.FloorArea : 0,</span>
              <span class="s0">UValueWindow: selectedProperty ? selectedProperty.WindowArea : 0,</span>
              <span class="s0">UValueDoor: selectedProperty ? selectedProperty.DoorArea : 0</span>
            <span class="s0">};</span>

            <span class="s0">// Find matching row for new energy rating and dwelling type</span>
            <span class="s0">const matchedRow = result.data.find(row =&gt;</span>
              <span class="s0">row.DwellingType === dwellingType &amp;&amp; row.EnergyRating === newRating);</span>

            <span class="s0">// If a matching row is found, update the threshold values</span>
            <span class="s0">if (matchedRow) {</span>
              <span class="s0">setThresholdValues({</span>
                <span class="s0">wall: parseFloat(matchedRow.UValueWallMean),</span>
                <span class="s0">roof: parseFloat(matchedRow.UValueRoofMean),</span>
                <span class="s0">floor: parseFloat(matchedRow.UValueFloorMean),</span>
                <span class="s0">window: parseFloat(matchedRow.UValueWindowMean),</span>
                <span class="s0">door: parseFloat(matchedRow.UValueDoorMean)</span>
              <span class="s0">});</span>
            <span class="s0">}</span>

            <span class="s0">// Calculate the grants and costs based on the selected property</span>
            <span class="s0">const newEstimates = {};</span>
            <span class="s0">seaiGrants.forEach(grant =&gt; {</span>
              <span class="s0">if (grant.DwellingTypes === dwellingType) {</span>
                <span class="s0">Object.keys(areaMappings).forEach(key =&gt; {</span>
                  <span class="s0">// Map grant name to the UValue keys, adjust if necessary</span>
                  <span class="s0">const grantKey = grant.GrantName.replace(/\s+/g, '') + 'Insulation';</span>
                  <span class="s0">if (grantKey === key) {</span>
                    <span class="s0">newEstimates[key] = {</span>
                      <span class="s0">grantValue: parseFloat(grant.GrantValue),</span>
                      <span class="s0">estimatedImprovementCost: parseFloat(grant.EstimatedImprovementCost) * areaMappings[key]</span>
                      <span class="s0">// Calculate other fields as needed</span>
                    <span class="s0">};</span>
                  <span class="s0">}</span>
                <span class="s0">});</span>
              <span class="s0">}</span>
            <span class="s0">});</span>
            <span class="s0">setImprovementEstimates(newEstimates);</span>
          <span class="s0">}</span>
        <span class="s0">});</span>
      <span class="s0">});</span>
  <span class="s0">}, [selectedProperty, newEnergyRating, seaiGrants]); // Ensure useEffect is triggered when these values change</span>

  <span class="s0">// Display the selected property and inputs for modifying U-values</span>
  <span class="s0">return (</span>
        <span class="s0">&lt;div&gt;</span>
            <span class="s0">&lt;h1&gt;Selected Property&lt;/h1&gt;</span>
            <span class="s0">{selectedProperty &amp;&amp; (</span>
                <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
                  <span class="s0">&lt;p&gt;&lt;strong&gt;Dwelling Type:&lt;/strong&gt; {selectedProperty.DwellingTypeDescr}&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;&lt;strong&gt;Current Energy Rating:&lt;/strong&gt; {selectedProperty.EnergyRating}&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;&lt;/p&gt;</span>
                  <span class="s0">&lt;h2&gt;Select New Energy Rating&lt;/h2&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">Choosing a new Energy Rating for your home is a proactive step towards enhancing your living</span>
                    <span class="s0">environment and reducing your energy costs.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">A higher Energy Rating signifies better thermal efficiency, meaning your home retains heat more</span>
                    <span class="s0">effectively during winter and stays cooler during summer.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">This not only improves comfort but also reduces the need for excessive heating or</span>
                    <span class="s0">cooling, leading to significant savings on energy bills.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">Additionally, upgrading your home&amp;apos;s energy performance can increase its market</span>
                    <span class="s0">value and reduce its environmental impact by lowering carbon emissions.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">Select a new Energy Rating below to see how you can achieve these benefits.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;select value={newEnergyRating} onChange={e =&gt; setNewEnergyRating(e.target.value)}&gt;</span>
                    <span class="s0">&lt;option value=&quot;&quot;&gt;Select New Energy Rating&lt;/option&gt;</span>
                    <span class="s0">{availableRatings &amp;&amp; availableRatings.map(rating =&gt; &lt;option key={rating}</span>
                                                                                <span class="s0">value={rating}&gt;{rating}&lt;/option&gt;)}</span>
                  <span class="s0">&lt;/select&gt;</span>
                  <span class="s0">&lt;button onClick={submitNewEnergyRating} className=&quot;button-blue&quot;&gt;Submit&lt;/button&gt;</span>
                  <span class="s0">&lt;h2&gt;Current U-Values&lt;/h2&gt;</span>
                  <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                    <span class="s0">&lt;thead&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;U-Value Types&lt;/th&gt;</span>
                      <span class="s0">&lt;th&gt;Target U-Values&lt;/th&gt;</span>
                      <span class="s0">&lt;th&gt;Existing U-Values&lt;/th&gt;</span>
                      <span class="s0">&lt;th&gt;Description&lt;/th&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;/thead&gt;</span>
                    <span class="s0">&lt;tbody&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Walls UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.wall}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueWall}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01</span>
                          <span class="s0">? 'Your walls are not holding heat well. Consider upgrading insulation.'</span>
                          <span class="s0">: selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01</span>
                            <span class="s0">? 'Your walls are well insulated against heat loss.'</span>
                            <span class="s0">: 'Your walls meet the minimum standard, but improvements could still be beneficial.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Roof UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.roof}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueRoof - thresholdValues.roof &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueRoof - thresholdValues.roof &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueRoof}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UValueRoof - thresholdValues.roof &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueRoof - thresholdValues.roof &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueRoof &gt; thresholdValues.roof</span>
                          <span class="s0">? 'Heat is escaping through your roof. Consider upgrading insulation.'</span>
                          <span class="s0">: selectedProperty.UValueRoof === thresholdValues.roof</span>
                            <span class="s0">? 'Your roof meets the minimum standard, but improvements could still be beneficial.'</span>
                            <span class="s0">: 'Your roof is well insulated against heat loss.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Floors UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.floor}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueFloor - thresholdValues.floor &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueFloor - thresholdValues.floor &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueFloor}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UValueFloor - thresholdValues.floor &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueFloor - thresholdValues.floor &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueFloor &gt; thresholdValues.floor</span>
                          <span class="s0">? 'Your floors are losing heat, consider improving insulation.'</span>
                          <span class="s0">: selectedProperty.UValueFloor === thresholdValues.floor</span>
                            <span class="s0">? 'Your floors meet the standard, but consider enhancements for better warmth.'</span>
                            <span class="s0">: 'Your floors are retaining heat efficiently.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Windows UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.window}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueWindow - thresholdValues.window &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWindow - thresholdValues.window &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueWindow}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UValueWindow - thresholdValues.window &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWindow - thresholdValues.window &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueWindow &gt; thresholdValues.window</span>
                          <span class="s0">? 'Your windows are not keeping heat in effectively. Consider updating them.'</span>
                          <span class="s0">: selectedProperty.UValueWindow === thresholdValues.window</span>
                            <span class="s0">? 'Your windows are adequate, but newer models could offer more savings.'</span>
                            <span class="s0">: 'Your windows are performing well in retaining heat.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Doors UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.door}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UvalueDoor - thresholdValues.door &gt; 0.01 ? 'u-value-high' : selectedProperty.UvalueDoor - thresholdValues.door &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UvalueDoor}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UvalueDoor - thresholdValues.door &gt; 0.01 ? 'u-value-high' : selectedProperty.UvalueDoor - thresholdValues.door &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UvalueDoor &gt; thresholdValues.door</span>
                          <span class="s0">? 'Your doors are not insulating well. Consider replacements or sealing gaps.'</span>
                          <span class="s0">: selectedProperty.UvalueDoor === thresholdValues.door</span>
                            <span class="s0">? 'Your doors meet the current standard, yet there might be room for improvement.'</span>
                            <span class="s0">: 'Your doors are well-sealed and insulated.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;/tbody&gt;</span>
                  <span class="s0">&lt;/table&gt;</span>
                  <span class="s0">&lt;h2&gt;Select U-Values to Modify&lt;/h2&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWall}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWall')}/&gt;</span>
                      <span class="s0">Wall</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueRoof}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueRoof')}/&gt;</span>
                      <span class="s0">Roof</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueFloor}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueFloor')}/&gt;</span>
                      <span class="s0">Floor</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWindow}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWindow')}/&gt;</span>
                      <span class="s0">Window</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueDoor}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueDoor')}/&gt;</span>
                      <span class="s0">Door</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>

                  <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
                    <span class="s0">&lt;h2&gt;Improvement Estimates&lt;/h2&gt;</span>
                    <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                      <span class="s0">&lt;thead&gt;</span>
                      <span class="s0">&lt;tr&gt;</span>
                        <span class="s0">&lt;th&gt;Improvement&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Quantity&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Estimated Works Cost&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Available SEAI Grant&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Estimated Cost to Homeowner&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Apply for Grant&lt;/th&gt;</span>
                      <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">&lt;/thead&gt;</span>
                      <span class="s0">&lt;tbody&gt;</span>
                      <span class="s0">{/* Wall improvements */}</span>
                      <span class="s0">{selectedUValues.UValueWall &amp;&amp; Object.entries(improvementEstimates).filter(([key]) =&gt; key.includes('Wall')).map(([key, values]) =&gt; (</span>
                          <span class="s0">&lt;tr key={key}&gt;</span>
                            <span class="s0">&lt;td&gt;{key}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.estimatedImprovementCost}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.grantValue}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.estimatedImprovementCost - values.grantValue}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                   <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                          <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">))}</span>

                      <span class="s0">{/* Roof improvements */}</span>
                      <span class="s0">{selectedUValues.UValueRoof &amp;&amp; Object.entries(improvementEstimates).filter(([key]) =&gt; key.includes('Roof') || key.includes('Attic')).map(([key, values]) =&gt; (</span>
                          <span class="s0">&lt;tr key={key}&gt;</span>
                            <span class="s0">&lt;td&gt;{key}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.estimatedImprovementCost}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.grantValue}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.estimatedImprovementCost - values.grantValue}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                   <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                          <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">))}</span>

                      <span class="s0">{/* Floor improvements */}</span>
                      <span class="s0">{selectedUValues.UValueFloor &amp;&amp; Object.entries(improvementEstimates).filter(([key]) =&gt; key.includes('Floor')).map(([key, values]) =&gt; (</span>
                          <span class="s0">&lt;tr key={key}&gt;</span>
                            <span class="s0">&lt;td&gt;{key}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.estimatedImprovementCost}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.grantValue}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.estimatedImprovementCost - values.grantValue}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                   <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                          <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">))}</span>

                      <span class="s0">{/* Windows improvements - User input for number of windows required */}</span>
                      <span class="s0">{selectedUValues.UValueWindow &amp;&amp; (</span>
                          <span class="s0">&lt;tr&gt;</span>
                            <span class="s0">&lt;td&gt;Windows Replacement&lt;/td&gt;</span>
                            <span class="s0">{/* Assuming you have a state to hold the number of windows the user wants to replace */}</span>
                            <span class="s0">&lt;td&gt;{improvementEstimates.Windows ? improvementEstimates.Windows.estimatedImprovementCost * numberOfWindows : 'N/A'}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{improvementEstimates.Windows ? improvementEstimates.Windows.grantValue * numberOfWindows : 'N/A'}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{improvementEstimates.Windows ? (improvementEstimates.Windows.estimatedImprovementCost - improvementEstimates.Windows.grantValue) * numberOfWindows : 'N/A'}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                   <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                          <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">)}</span>

                      <span class="s0">{/* Door improvements */}</span>
                      <span class="s0">{selectedUValues.UValueDoor &amp;&amp; Object.entries(improvementEstimates).filter(([key]) =&gt; key.includes('Door')).map(([key, values]) =&gt; (</span>
                          <span class="s0">&lt;tr key={key}&gt;</span>
                            <span class="s0">&lt;td&gt;{key}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.estimatedImprovementCost}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.grantValue}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{values.estimatedImprovementCost - values.grantValue}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants</span>
            <span class="s0">&lt;td&gt;&lt;a href=&quot; https:// www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                   <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                          <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">))}</span>
                      <span class="s0">&lt;/tbody&gt;</span>
                    <span class="s0">&lt;/table&gt;</span>
                    <span class="s0">{/* You can add additional instructions or information below the table */}</span>
                  <span class="s0">&lt;/div&gt;</span>

                <span class="s0">&lt;/div&gt;</span>
            <span class="s0">)}</span>
        <span class="s0">&lt;/div&gt;</span>
  <span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">export default SuggestionsPage;</span>


<span class="s0">Modified 18/03/2024</span>

<span class="s0">import React, { useState, useEffect } from 'react';</span>
<span class="s0">import { useLocation } from 'react-router-dom';</span>
<span class="s0">import Papa from 'papaparse';</span>

<span class="s0">function SuggestionsPage () {</span>
  <span class="s0">const location = useLocation();</span>
  <span class="s0">const selectedProperty = location.state ? location.state.selectedProperty : null;</span>
  <span class="s0">const selectedDwellingType = useState('');</span>
  <span class="s0">const [newEnergyRating, setNewEnergyRating] = useState('');</span>
  <span class="s0">const [archetypeData, setArchetypeData] = useState([]);</span>
  <span class="s0">const [modifiedValues, setModifiedValues] = useState({});</span>
  <span class="s0">const [selectedUValues, setSelectedUValues] = useState({});</span>

  <span class="s0">const handleValueChange = (field, value) =&gt; {</span>
    <span class="s0">setModifiedValues(prev =&gt; ({ ...prev, [field]: value }));</span>
  <span class="s0">};</span>

  <span class="s0">const availableRatings = selectedProperty &amp;&amp; ['A1', 'A2', 'A3', 'B1', 'B2'].filter(rating =&gt; rating !== selectedProperty.EnergyRating &amp;&amp; rating &lt; selectedProperty.EnergyRating);</span>

  <span class="s0">const [thresholdValues, setThresholdValues] = useState({</span>
    <span class="s0">wall: 0, // Default values, will be updated dynamically</span>
    <span class="s0">roof: 0,</span>
    <span class="s0">floor: 0,</span>
    <span class="s0">window: 0,</span>
    <span class="s0">door: 0</span>
  <span class="s0">});</span>

  <span class="s0">const improvementCosts = {</span>
    <span class="s0">UValueWall: 5000, // example costs in currency units</span>
    <span class="s0">UValueRoof: 4000,</span>
    <span class="s0">UValueFloor: 3000,</span>
    <span class="s0">UValueWindow: 2000,</span>
    <span class="s0">UValueDoor: 1000</span>
  <span class="s0">};</span>

  <span class="s0">const availableGrants = {</span>
    <span class="s0">UValueWall: 2000, // example grant amounts in currency units</span>
    <span class="s0">UValueRoof: 1500,</span>
    <span class="s0">UValueFloor: 1000,</span>
    <span class="s0">UValueWindow: 500,</span>
    <span class="s0">UValueDoor: 250</span>
  <span class="s0">};</span>

  <span class="s0">const handleUValueChange = (e, field) =&gt; {</span>
    <span class="s0">setSelectedUValues({ ...selectedUValues, [field]: e.target.checked });</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewUValues = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewEnergyRating = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">useEffect(() =&gt; {</span>
    <span class="s0">// Scrolls the window to the top of the new page</span>
    <span class="s0">window.scrollTo(0, 0);</span>

    <span class="s0">// Fetch archetype data once at the start or when the selected property changes</span>
    <span class="s0">fetch('/data/data_building_archetype.csv')</span>
      <span class="s0">.then(response =&gt; response.text())</span>
      <span class="s0">.then(text =&gt; {</span>
        <span class="s0">Papa.parse(text, {</span>
          <span class="s0">header: true,</span>
          <span class="s0">complete: result =&gt; {</span>
            <span class="s0">// Set the full dataset (if you need to use it elsewhere)</span>
            <span class="s0">setArchetypeData(result.data);</span>

            <span class="s0">// Assuming selectedDwellingType holds type like 'Semi-detached house'</span>
            <span class="s0">const dwellingType = selectedProperty ? selectedProperty.DwellingTypeDescr : '';</span>
            <span class="s0">const newRating = newEnergyRating;</span>

            <span class="s0">// Find matching row for new energy rating and dwelling type</span>
            <span class="s0">const matchedRow = result.data.find(row =&gt;</span>
              <span class="s0">row.DwellingType === dwellingType &amp;&amp; row.EnergyRating === newRating);</span>

            <span class="s0">// If a matching row is found, update the threshold values</span>
            <span class="s0">if (matchedRow) {</span>
              <span class="s0">setThresholdValues({</span>
                <span class="s0">wall: parseFloat(matchedRow.UValueWallMean),</span>
                <span class="s0">roof: parseFloat(matchedRow.UValueRoofMean),</span>
                <span class="s0">floor: parseFloat(matchedRow.UValueFloorMean),</span>
                <span class="s0">window: parseFloat(matchedRow.UValueWindowMean),</span>
                <span class="s0">door: parseFloat(matchedRow.UValueDoorMean)</span>
              <span class="s0">});</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
        <span class="s0">});</span>
      <span class="s0">});</span>
  <span class="s0">}, [selectedProperty, newEnergyRating]); // Ensure useEffect is triggered when these values change</span>

  <span class="s0">// Display the selected property and inputs for modifying U-values</span>
  <span class="s0">return (</span>
        <span class="s0">&lt;div&gt;</span>
            <span class="s0">&lt;h1&gt;Selected Property&lt;/h1&gt;</span>
            <span class="s0">{selectedProperty &amp;&amp; (</span>
                <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
                  <span class="s0">&lt;p&gt;&lt;strong&gt;Dwelling Type:&lt;/strong&gt; {selectedProperty.DwellingTypeDescr}&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;&lt;strong&gt;Current Energy Rating:&lt;/strong&gt; {selectedProperty.EnergyRating}&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;&lt;/p&gt;</span>
                  <span class="s0">&lt;h2&gt;Select New Energy Rating&lt;/h2&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">Choosing a new Energy Rating for your home is a proactive step towards enhancing your living</span>
                    <span class="s0">environment and reducing your energy costs.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">A higher Energy Rating signifies better thermal efficiency, meaning your home retains heat more</span>
                    <span class="s0">effectively during winter and stays cooler during summer.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">This not only improves comfort but also reduces the need for excessive heating or</span>
                    <span class="s0">cooling, leading to significant savings on energy bills.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">Additionally, upgrading your home&amp;apos;s energy performance can increase its market</span>
                    <span class="s0">value and reduce its environmental impact by lowering carbon emissions.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">Select a new Energy Rating below to see how you can achieve these benefits.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;select value={newEnergyRating} onChange={e =&gt; setNewEnergyRating(e.target.value)}&gt;</span>
                    <span class="s0">&lt;option value=&quot;&quot;&gt;Select New Energy Rating&lt;/option&gt;</span>
                    <span class="s0">{availableRatings &amp;&amp; availableRatings.map(rating =&gt; &lt;option key={rating}</span>
                                                                                <span class="s0">value={rating}&gt;{rating}&lt;/option&gt;)}</span>
                  <span class="s0">&lt;/select&gt;</span>
                  <span class="s0">&lt;button onClick={submitNewEnergyRating} className=&quot;button-blue&quot;&gt;Submit&lt;/button&gt;</span>
                  <span class="s0">&lt;h2&gt;Current U-Values&lt;/h2&gt;</span>
                  <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                    <span class="s0">&lt;thead&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;U-Value Types&lt;/th&gt;</span>
                      <span class="s0">&lt;th&gt;Target U-Values&lt;/th&gt;</span>
                      <span class="s0">&lt;th&gt;Existing U-Values&lt;/th&gt;</span>
                      <span class="s0">&lt;th&gt;Description&lt;/th&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;/thead&gt;</span>
                    <span class="s0">&lt;tbody&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Walls UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.wall}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueWall}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueWall - thresholdValues.wall &gt; 0.01</span>
                          <span class="s0">? 'Your walls are not holding heat well. Consider upgrading insulation.'</span>
                          <span class="s0">: selectedProperty.UValueWall - thresholdValues.wall &lt; -0.01</span>
                            <span class="s0">? 'Your walls are well insulated against heat loss.'</span>
                            <span class="s0">: 'Your walls meet the minimum standard, but improvements could still be beneficial.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Roof UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.roof}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueRoof - thresholdValues.roof &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueRoof - thresholdValues.roof &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueRoof}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UValueRoof - thresholdValues.roof &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueRoof - thresholdValues.roof &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueRoof &gt; thresholdValues.roof</span>
                          <span class="s0">? 'Heat is escaping through your roof. Consider upgrading insulation.'</span>
                          <span class="s0">: selectedProperty.UValueRoof === thresholdValues.roof</span>
                            <span class="s0">? 'Your roof meets the minimum standard, but improvements could still be beneficial.'</span>
                            <span class="s0">: 'Your roof is well insulated against heat loss.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Floors UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.floor}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueFloor - thresholdValues.floor &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueFloor - thresholdValues.floor &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueFloor}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UValueFloor - thresholdValues.floor &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueFloor - thresholdValues.floor &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueFloor &gt; thresholdValues.floor</span>
                          <span class="s0">? 'Your floors are losing heat, consider improving insulation.'</span>
                          <span class="s0">: selectedProperty.UValueFloor === thresholdValues.floor</span>
                            <span class="s0">? 'Your floors meet the standard, but consider enhancements for better warmth.'</span>
                            <span class="s0">: 'Your floors are retaining heat efficiently.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Windows UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.window}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UValueWindow - thresholdValues.window &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWindow - thresholdValues.window &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueWindow}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UValueWindow - thresholdValues.window &gt; 0.01 ? 'u-value-high' : selectedProperty.UValueWindow - thresholdValues.window &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UValueWindow &gt; thresholdValues.window</span>
                          <span class="s0">? 'Your windows are not keeping heat in effectively. Consider updating them.'</span>
                          <span class="s0">: selectedProperty.UValueWindow === thresholdValues.window</span>
                            <span class="s0">? 'Your windows are adequate, but newer models could offer more savings.'</span>
                            <span class="s0">: 'Your windows are performing well in retaining heat.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Doors UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{thresholdValues.door}&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`value-cell ${selectedProperty.UvalueDoor - thresholdValues.door &gt; 0.01 ? 'u-value-high' : selectedProperty.UvalueDoor - thresholdValues.door &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UvalueDoor}</span>
                      <span class="s0">&lt;/td&gt;</span>
                      <span class="s0">&lt;td className={`${selectedProperty.UvalueDoor - thresholdValues.door &gt; 0.01 ? 'u-value-high' : selectedProperty.UvalueDoor - thresholdValues.door &lt; -0.01 ? 'u-value-low' : 'u-value-medium'}`}&gt;</span>
                        <span class="s0">{selectedProperty.UvalueDoor &gt; thresholdValues.door</span>
                          <span class="s0">? 'Your doors are not insulating well. Consider replacements or sealing gaps.'</span>
                          <span class="s0">: selectedProperty.UvalueDoor === thresholdValues.door</span>
                            <span class="s0">? 'Your doors meet the current standard, yet there might be room for improvement.'</span>
                            <span class="s0">: 'Your doors are well-sealed and insulated.'}</span>
                      <span class="s0">&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;/tbody&gt;</span>
                  <span class="s0">&lt;/table&gt;</span>
                  <span class="s0">&lt;h2&gt;Select U-Values to Modify&lt;/h2&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWall}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWall')}/&gt;</span>
                      <span class="s0">Wall</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueRoof}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueRoof')}/&gt;</span>
                      <span class="s0">Roof</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueFloor}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueFloor')}/&gt;</span>
                      <span class="s0">Floor</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWindow}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWindow')}/&gt;</span>
                      <span class="s0">Window</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueDoor}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueDoor')}/&gt;</span>
                      <span class="s0">Door</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>

                  <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
                    <span class="s0">&lt;h2&gt;Improvement Estimates&lt;/h2&gt;</span>
                    <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                      <span class="s0">&lt;thead&gt;</span>
                      <span class="s0">&lt;tr&gt;</span>
                        <span class="s0">&lt;th&gt;Improvement&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Estimated Works Cost&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Available SEAI Grant&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Estimated Cost to Homeowner&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Apply for Grant&lt;/th&gt;</span>
                      <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">&lt;/thead&gt;</span>
                      <span class="s0">&lt;tbody&gt;</span>
                      <span class="s0">{selectedUValues.UValueWall &amp;&amp; (</span>
                          <span class="s0">&lt;&gt;</span>
                            <span class="s0">&lt;tr&gt;</span>
                              <span class="s0">&lt;td&gt;Internal Wall Insulation&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;9,000&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;4,500&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;4,500&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                     <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                            <span class="s0">&lt;/tr&gt;</span>
                            <span class="s0">&lt;tr&gt;</span>
                              <span class="s0">&lt;td&gt;External Wall Insulation&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;16,000&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;8,000&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;8,000&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                     <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                            <span class="s0">&lt;/tr&gt;</span>
                            <span class="s0">&lt;tr&gt;</span>
                              <span class="s0">&lt;td&gt;Cavity Wall Insulation&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;2,200&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;1,700&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;500&lt;/td&gt;</span>
                              <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                     <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                            <span class="s0">&lt;/tr&gt;</span>
                          <span class="s0">&lt;/&gt;</span>
                      <span class="s0">)}</span>
                      <span class="s0">{selectedUValues.UValueRoof &amp;&amp; (</span>
                          <span class="s0">&lt;tr&gt;</span>
                            <span class="s0">&lt;td&gt;Roof/Attic Insulation&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;2,000&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;1,500&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;500&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;&lt;a href=&quot;https://www.seai.ie/grants/home-energy-grants/insulation-grants/&quot;</span>
                                   <span class="s0">target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; className=&quot;button-blue&quot;&gt;Apply&lt;/a&gt;&lt;/td&gt;</span>
                          <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">)}</span>
                      <span class="s0">{/* Repeat similar structures for UValueFloor, UValueWindow, UValueDoor if necessary */}</span>
                      <span class="s0">&lt;/tbody&gt;</span>
                    <span class="s0">&lt;/table&gt;</span>
                    <span class="s0">{/* You can add additional instructions or information below the table */}</span>
                  <span class="s0">&lt;/div&gt;</span>

                <span class="s0">&lt;/div&gt;</span>
            <span class="s0">)}</span>
        <span class="s0">&lt;/div&gt;</span>
  <span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">export default SuggestionsPage;</span>



<span class="s0">Modified 15/03/2024</span>

<span class="s0">import React, { useState, useEffect } from 'react';</span>
<span class="s0">import { useLocation } from 'react-router-dom';</span>
<span class="s0">import Papa from 'papaparse';</span>

<span class="s0">function SuggestionsPage () {</span>
  <span class="s0">const location = useLocation();</span>
  <span class="s0">const [selectedProperty, setSelectedProperty] = useState(location.state ? location.state.selectedProperty : null);</span>
  <span class="s0">const [newEnergyRating, setNewEnergyRating] = useState('');</span>
  <span class="s0">const [archetypeData, setArchetypeData] = useState([]);</span>
  <span class="s0">const [modifiedValues, setModifiedValues] = useState({});</span>
  <span class="s0">const [selectedUValues, setSelectedUValues] = useState({});</span>

  <span class="s0">const handleValueChange = (field, value) =&gt; {</span>
    <span class="s0">setModifiedValues(prev =&gt; ({ ...prev, [field]: value }));</span>
  <span class="s0">};</span>

  <span class="s0">useEffect(() =&gt; {</span>
    <span class="s0">// Fetch archetype data once at the start</span>
    <span class="s0">fetch('/data/data_building_archetype.csv')</span>
      <span class="s0">.then(response =&gt; response.text())</span>
      <span class="s0">.then(text =&gt; {</span>
        <span class="s0">Papa.parse(text, {</span>
          <span class="s0">header: true,</span>
          <span class="s0">complete: result =&gt; setArchetypeData(result.data)</span>
        <span class="s0">});</span>
      <span class="s0">});</span>
  <span class="s0">}, []);</span>

  <span class="s0">const availableRatings = selectedProperty &amp;&amp; ['A1', 'A2', 'A3', 'B1', 'B2', 'B3', 'C1', 'C2', 'C3', 'D1', 'D2'].filter(rating =&gt; rating !== selectedProperty.EnergyRating &amp;&amp; rating &lt; selectedProperty.EnergyRating);</span>

  <span class="s0">const thresholdValues = {</span>
    <span class="s0">wall: 0.36,</span>
    <span class="s0">roof: 0.22,</span>
    <span class="s0">floor: 0.34,</span>
    <span class="s0">window: 2.10,</span>
    <span class="s0">door: 2.05</span>
  <span class="s0">};</span>

  <span class="s0">const improvementCosts = {</span>
    <span class="s0">UValueWall: 5000, // example costs in currency units</span>
    <span class="s0">UValueRoof: 4000,</span>
    <span class="s0">UValueFloor: 3000,</span>
    <span class="s0">UValueWindow: 2000,</span>
    <span class="s0">UValueDoor: 1000</span>
  <span class="s0">};</span>

  <span class="s0">const availableGrants = {</span>
    <span class="s0">UValueWall: 2000, // example grant amounts in currency units</span>
    <span class="s0">UValueRoof: 1500,</span>
    <span class="s0">UValueFloor: 1000,</span>
    <span class="s0">UValueWindow: 500,</span>
    <span class="s0">UValueDoor: 250</span>
  <span class="s0">};</span>

  <span class="s0">const handleUValueChange = (e, field) =&gt; {</span>
    <span class="s0">setSelectedUValues({ ...selectedUValues, [field]: e.target.checked });</span>
  <span class="s0">};</span>

  <span class="s0">const submitNewUValues = () =&gt; {</span>
    <span class="s0">// Logic to calculate predicted results based on new U-values</span>
    <span class="s0">console.log('New U-Values submitted:', selectedUValues);</span>
    <span class="s0">// You might want to set some results state here based on the new U-values</span>
  <span class="s0">};</span>

  <span class="s0">// Display the selected property and inputs for modifying U-values</span>
  <span class="s0">return (</span>
        <span class="s0">&lt;div&gt;</span>
            <span class="s0">&lt;h1&gt;Selected Property&lt;/h1&gt;</span>
            <span class="s0">{selectedProperty &amp;&amp; (</span>
                <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
                  <span class="s0">&lt;p&gt;Dwelling Type: {selectedProperty.DwellingTypeDescr}&lt;/p&gt;</span>
                  <span class="s0">&lt;p&gt;Current Energy Rating: {selectedProperty.EnergyRating}&lt;/p&gt;</span>
                  <span class="s0">&lt;h2&gt;Current U-Values&lt;/h2&gt;</span>
                  <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                    <span class="s0">&lt;thead&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;U-Value Types&lt;/th&gt;</span>
                      <span class="s0">&lt;th&gt;Existing Value&lt;/th&gt;</span>
                      <span class="s0">&lt;th&gt;Description&lt;/th&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;/thead&gt;</span>
                    <span class="s0">&lt;tbody&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Walls UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UValueWall}&lt;/td&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UValueWall &gt; thresholdValues.wall ? 'Your walls are not holding heat well. This could mean your wall insulation is thin, old, or missing. Your home may feel colder and your heating bills may be higher.' : 'Your walls are good at keeping heat inside your home. This means your wall insulation is effective. Your home should feel warmer and your heating bills should be lower..'}&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Roof UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UValueRoof}&lt;/td&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UValueRoof &gt; thresholdValues.roof ? 'Heat is escaping through your roof. This often means your roof insulation is insufficient or absent. Your top floors may be chilly, and heating costs could be high.' : 'Your roof is well insulated, keeping heat from escaping. This helps maintain a comfortable temperature throughout your home and can reduce heating costs.'}&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Floors UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UValueFloor}&lt;/td&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UValueFloor &gt; thresholdValues.floor ? 'Your floors are losing heat, which can make them feel cold underfoot. This usually means there\'s inadequate insulation beneath them. This can lead to colder room temperatures and higher heating bills.' : 'Your floors are effective at retaining heat, which can help keep your feet and room warmer. Good floor insulation contributes to overall warmth and energy efficiency in your home.'}&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Windows UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UValueWindow}&lt;/td&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UValueWindow &gt; thresholdValues.window ? 'Your windows are not very good at keeping heat inside. This could be because they are old, single-glazed, or poorly fitted, leading to drafts and cold spots near windows.' : 'Your windows are doing a good job of keeping heat in. They are likely double or triple-glazed and well-sealed, helping to maintain a comfortable temperature and reduce noise from outside.'}&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;tr&gt;</span>
                      <span class="s0">&lt;th&gt;Doors UValue&lt;/th&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UvalueDoor}&lt;/td&gt;</span>
                      <span class="s0">&lt;td&gt;{selectedProperty.UvalueDoor &gt; thresholdValues.door ? 'Your doors allow heat to escape easily, which can make your home feel drafty, particularly near doors. This might mean the doors are old, poorly insulated, or not fitting correctly.' : 'Your doors are well insulated and fitted, helping to keep heat in and cold out. This contributes to a warmer, more energy-efficient home.'}&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                    <span class="s0">&lt;/tbody&gt;</span>
                  <span class="s0">&lt;/table&gt;</span>
                  <span class="s0">&lt;p&gt;&lt;/p&gt;</span>
                  <span class="s0">&lt;h2&gt;Select New Energy Rating&lt;/h2&gt;</span>
                  <span class="s0">&lt;p&gt;</span>
                    <span class="s0">Choosing a new Energy Rating for your home is a proactive step towards enhancing your living</span>
                    <span class="s0">environment and reducing your energy costs.</span>
                    <span class="s0">A higher Energy Rating signifies better thermal efficiency, meaning your home retains heat more</span>
                    <span class="s0">effectively during winter and stays cooler</span>
                    <span class="s0">during summer. This not only improves comfort but also reduces the need for excessive heating or</span>
                    <span class="s0">cooling, leading to significant savings on</span>
                    <span class="s0">energy bills. Additionally, upgrading your home&amp;pos;s energy performance can increase its market value</span>
                    <span class="s0">and reduce its environmental impact</span>
                    <span class="s0">by lowering carbon emissions. Select a new Energy Rating below to see how you can achieve these</span>
                    <span class="s0">benefits.</span>
                  <span class="s0">&lt;/p&gt;</span>
                  <span class="s0">&lt;select value={newEnergyRating} onChange={e =&gt; setNewEnergyRating(e.target.value)}&gt;</span>
                    <span class="s0">&lt;option value=&quot;&quot;&gt;Select New Energy Rating&lt;/option&gt;</span>
                    <span class="s0">{availableRatings &amp;&amp; availableRatings.map(rating =&gt; &lt;option key={rating}</span>
                                                                                <span class="s0">value={rating}&gt;{rating}&lt;/option&gt;)}</span>
                  <span class="s0">&lt;/select&gt;</span>
                  <span class="s0">&lt;h2&gt;Select U-Values to Modify&lt;/h2&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWall}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWall')}/&gt;</span>
                      <span class="s0">Wall</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueRoof}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueRoof')}/&gt;</span>
                      <span class="s0">Roof</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueFloor}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueFloor')}/&gt;</span>
                      <span class="s0">Floor</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueWindow}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueWindow')}/&gt;</span>
                      <span class="s0">Window</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;label&gt;</span>
                      <span class="s0">&lt;input type=&quot;checkbox&quot; checked={!!selectedUValues.UValueDoor}</span>
                             <span class="s0">onChange={(e) =&gt; handleUValueChange(e, 'UValueDoor')}/&gt;</span>
                      <span class="s0">Door</span>
                    <span class="s0">&lt;/label&gt;</span>
                  <span class="s0">&lt;/div&gt;</span>
                  <span class="s0">&lt;button onClick={submitNewUValues} className=&quot;button-blue&quot;&gt;Submit New U-Values&lt;/button&gt;</span>
                  <span class="s0">&lt;div className=&quot;u-values-card&quot;&gt;</span>
                    <span class="s0">&lt;h2&gt;Improvement Estimates&lt;/h2&gt;</span>
                    <span class="s0">&lt;table className=&quot;u-values-table&quot;&gt;</span>
                      <span class="s0">&lt;thead&gt;</span>
                      <span class="s0">&lt;tr&gt;</span>
                        <span class="s0">&lt;th&gt;Improvement&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Estimated Works Cost&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Available Grant&lt;/th&gt;</span>
                        <span class="s0">&lt;th&gt;Estimated Cost to Homeowner&lt;/th&gt;</span>
                      <span class="s0">&lt;/tr&gt;</span>
                      <span class="s0">&lt;/thead&gt;</span>
                      <span class="s0">&lt;tbody&gt;</span>
                      <span class="s0">{Object.entries(modifiedValues).map(([key, value]) =&gt; {</span>
                        <span class="s0">// Only display rows for values the user chose to modify</span>
                        <span class="s0">if (value) {</span>
                          <span class="s0">return (</span>
                              <span class="s0">&lt;tr key={key}&gt;</span>
                                <span class="s0">&lt;td&gt;{key.replace('UValue', '')} Insulation&lt;/td&gt;</span>
                                <span class="s0">&lt;td&gt;{improvementCosts[key]}&lt;/td&gt;</span>
                                <span class="s0">&lt;td&gt;{availableGrants[key]}&lt;/td&gt;</span>
                                <span class="s0">&lt;td&gt;{improvementCosts[key] - availableGrants[key]}&lt;/td&gt;</span>
                              <span class="s0">&lt;/tr&gt;</span>
                          <span class="s0">);</span>
                        <span class="s0">} else {</span>
                          <span class="s0">return null;</span>
                        <span class="s0">}</span>
                      <span class="s0">})}</span>
                      <span class="s0">&lt;/tbody&gt;</span>
                    <span class="s0">&lt;/table&gt;</span>
                    <span class="s0">{/* You can add additional instructions or information below the table */}</span>
                  <span class="s0">&lt;/div&gt;</span>

                <span class="s0">&lt;/div&gt;</span>
            <span class="s0">)}</span>
        <span class="s0">&lt;/div&gt;</span>
  <span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">export default SuggestionsPage;</span>


<span class="s0">Modified 13/03/2024</span>
<span class="s0">import React, { useState, useEffect } from 'react';</span>
<span class="s0">import { useLocation } from 'react-router-dom';</span>
<span class="s0">import Papa from 'papaparse';</span>

<span class="s0">function SuggestionsPage () {</span>
  <span class="s0">const location = useLocation();</span>
  <span class="s0">const [selectedProperty, setSelectedProperty] = useState(location.state.selectedProperty);</span>
  <span class="s0">const [modifiedValues, setModifiedValues] = useState({});</span>

  <span class="s0">const handleValueChange = (field, value) =&gt; {</span>
    <span class="s0">setModifiedValues(prev =&gt; ({ ...prev, [field]: value }));</span>
  <span class="s0">};</span>

  <span class="s0">useEffect(() =&gt; {</span>
    <span class="s0">// Assuming you need to fetch new energy ratings based on modified U-values</span>
    <span class="s0">fetch('/data/data_building_archetype.csv')</span>
      <span class="s0">.then(response =&gt; response.text())</span>
      <span class="s0">.then(csvText =&gt; {</span>
        <span class="s0">Papa.parse(csvText, {</span>
          <span class="s0">header: true, // Assuming your CSV has headers</span>
          <span class="s0">complete: (result) =&gt; {</span>
            <span class="s0">console.log(result.data);</span>
            <span class="s0">// Do something with the data based on modified U-values</span>
          <span class="s0">}</span>
        <span class="s0">});</span>
      <span class="s0">});</span>
  <span class="s0">}, [modifiedValues]); // Rerun when modifiedValues changes</span>

  <span class="s0">// Display the selected property and inputs for modifying U-values</span>
  <span class="s0">return (</span>
        <span class="s0">&lt;div&gt;</span>
            <span class="s0">&lt;h1&gt;Selected Property&lt;/h1&gt;</span>
            <span class="s0">{selectedProperty &amp;&amp; (</span>
                <span class="s0">&lt;div&gt;</span>
                    <span class="s0">&lt;p&gt;Dwelling Type: {selectedProperty.DwellingTypeDescr}&lt;/p&gt;</span>
                    <span class="s0">&lt;p&gt;Energy Rating: {selectedProperty.EnergyRating}&lt;/p&gt;</span>
                    <span class="s0">&lt;table&gt;</span>
                        <span class="s0">&lt;thead&gt;</span>
                        <span class="s0">&lt;tr&gt;</span>
                            <span class="s0">&lt;th&gt;UValue Wall&lt;/th&gt;</span>
                            <span class="s0">&lt;th&gt;UValue Roof&lt;/th&gt;</span>
                            <span class="s0">&lt;th&gt;UValue Floor&lt;/th&gt;</span>
                            <span class="s0">&lt;th&gt;UValue Window&lt;/th&gt;</span>
                            <span class="s0">&lt;th&gt;UValue Door&lt;/th&gt;</span>
                        <span class="s0">&lt;/tr&gt;</span>
                        <span class="s0">&lt;/thead&gt;</span>
                        <span class="s0">&lt;tbody&gt;</span>
                        <span class="s0">&lt;tr&gt;</span>
                            <span class="s0">&lt;td&gt;{selectedProperty.UValueWall}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{selectedProperty.UValueRoof}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{selectedProperty.UValueFloor}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{selectedProperty.UValueWindow}&lt;/td&gt;</span>
                            <span class="s0">&lt;td&gt;{selectedProperty.UvalueDoor}&lt;/td&gt;</span>
                        <span class="s0">&lt;/tr&gt;</span>
                        <span class="s0">&lt;/tbody&gt;</span>
                    <span class="s0">&lt;/table&gt;</span>
                    <span class="s0">&lt;div&gt;</span>
                        <span class="s0">&lt;label&gt;Modify Wall U-Value:&lt;/label&gt;</span>
                        <span class="s0">&lt;input</span>
                            <span class="s0">type=&quot;number&quot;</span>
                            <span class="s0">value={modifiedValues.UValueWall || selectedProperty.UValueWall}</span>
                            <span class="s0">onChange={e =&gt; handleValueChange('UValueWall', e.target.value)}</span>
                        <span class="s0">/&gt;</span>
                    <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;div&gt;</span>
                        <span class="s0">&lt;label&gt;Modify Roof U-Value:&lt;/label&gt;</span>
                        <span class="s0">&lt;input</span>
                            <span class="s0">type=&quot;number&quot;</span>
                            <span class="s0">value={modifiedValues.UValueRoof || selectedProperty.UValueRoof}</span>
                            <span class="s0">onChange={e =&gt; handleValueChange('UValueRoof', e.target.value)}</span>
                        <span class="s0">/&gt;</span>
                    <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;div&gt;</span>
                        <span class="s0">&lt;label&gt;Modify Floor U-Value:&lt;/label&gt;</span>
                        <span class="s0">&lt;input</span>
                            <span class="s0">type=&quot;number&quot;</span>
                            <span class="s0">value={modifiedValues.UValueFloor || selectedProperty.UValueFloor}</span>
                            <span class="s0">onChange={e =&gt; handleValueChange('UValueFloor', e.target.value)}</span>
                        <span class="s0">/&gt;</span>
                    <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;div&gt;</span>
                        <span class="s0">&lt;label&gt;Modify Window U-Value:&lt;/label&gt;</span>
                        <span class="s0">&lt;input</span>
                            <span class="s0">type=&quot;number&quot;</span>
                            <span class="s0">value={modifiedValues.UValueWindow || selectedProperty.UValueWindow}</span>
                            <span class="s0">onChange={e =&gt; handleValueChange('UValueWindow', e.target.value)}</span>
                        <span class="s0">/&gt;</span>
                    <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">&lt;div&gt;</span>
                        <span class="s0">&lt;label&gt;Modify Door U-Value:&lt;/label&gt;</span>
                        <span class="s0">&lt;input</span>
                            <span class="s0">type=&quot;number&quot;</span>
                            <span class="s0">value={modifiedValues.UvalueDoor || selectedProperty.UvalueDoor}</span>
                            <span class="s0">onChange={e =&gt; handleValueChange('UvalueDoor', e.target.value)}</span>
                        <span class="s0">/&gt;</span>
                    <span class="s0">&lt;/div&gt;</span>
                    <span class="s0">{/* Add here any additional logic or display elements */}</span>
                <span class="s0">&lt;/div&gt;</span>
            <span class="s0">)}</span>
        <span class="s0">&lt;/div&gt;</span>
  <span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">export default SuggestionsPage;</span>




<span class="s0">Modified Feb 2024</span>
<span class="s0">import React, { useState, useEffect } from 'react';</span>
<span class="s0">import Papa from 'papaparse';</span>

<span class="s0">function SuggestionsPage () {</span>
  <span class="s0">const [properties, setProperties] = useState([]);</span>

  <span class="s0">useEffect(() =&gt; {</span>
    <span class="s0">fetch('/data/data_building_archetype.csv')</span>
      <span class="s0">.then(response =&gt; response.text())</span>
      <span class="s0">.then(csvText =&gt; {</span>
        <span class="s0">Papa.parse(csvText, {</span>
          <span class="s0">header: true, // Assuming your CSV has headers</span>
          <span class="s0">complete: (result) =&gt; {</span>
            <span class="s0">console.log(result.data);</span>
            <span class="s0">setProperties(result.data);</span>
          <span class="s0">}</span>
        <span class="s0">});</span>
      <span class="s0">});</span>
  <span class="s0">}, []);</span>

  <span class="s0">// Assuming you have a Property component to display each</span>
  <span class="s0">return (</span>
        <span class="s0">&lt;div&gt;</span>
            <span class="s0">&lt;h1&gt;Property List&lt;/h1&gt;</span>
            <span class="s0">&lt;table&gt;</span>
                <span class="s0">&lt;thead&gt;</span>
                <span class="s0">&lt;tr&gt;</span>
                    <span class="s0">&lt;th&gt;Dwelling Type&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Energy Rating&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;Ber Rating Mean&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;UValue Wall Mean&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;UValue Roof Mean&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;UValue Floor Mean&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;UValue Window Mean&lt;/th&gt;</span>
                    <span class="s0">&lt;th&gt;UValue Door Mean&lt;/th&gt;</span>
                <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">&lt;/thead&gt;</span>
                <span class="s0">&lt;tbody&gt;</span>
                <span class="s0">{properties.map((property, index) =&gt; (</span>
                    <span class="s0">&lt;tr key={index}&gt;</span>
                        <span class="s0">&lt;td&gt;{property.DwellingType}&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;{property.EnergyRating}&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;{property.BerRatingMean}&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;{property.UValueWallMean}&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;{property.UValueRoofMean}&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;{property.UValueFloorMean}&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;{property.UValueWindowMean}&lt;/td&gt;</span>
                        <span class="s0">&lt;td&gt;{property.UValueDoorMean}&lt;/td&gt;</span>
                    <span class="s0">&lt;/tr&gt;</span>
                <span class="s0">))}</span>
                <span class="s0">&lt;/tbody&gt;</span>
            <span class="s0">&lt;/table&gt;</span>
        <span class="s0">&lt;/div&gt;</span>
  <span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">export default SuggestionsPage;</span>



</pre>
</body>
</html>